# åˆ†æ­¥å·¥ä½œæµç¨‹å®Œæ•´å®ç°æŒ‡å—

## ğŸ“‹ æ›´æ–°æ‘˜è¦

æœ¬æ¬¡æ›´æ–°å®ç°äº†å®Œæ•´çš„ä¸‰æ­¥åˆ†ç¦»å·¥ä½œæµç¨‹ï¼š**Start â†’ æ‹“å±• â†’ æ£€ç´¢ â†’ ç”Ÿæˆ**

### ğŸ¯ æ ¸å¿ƒå˜æ›´

1. **Generate æŒ‰é’®æ”¹ä¸º Start**
2. **è‡ªåŠ¨åˆ‡æ¢åˆ° Retrieval é¢æ¿**
3. **æç¤ºè¯æ‹“å±•åŠ è½½çŠ¶æ€**
4. **æ£€ç´¢åŠ è½½çŠ¶æ€**
5. **åˆ†æ­¥ç”Ÿæˆæµç¨‹**
6. **ç¡®ä¿ä½¿ç”¨ retriever_v3ï¼ˆçº¯ MongoDB æ£€ç´¢ï¼‰**

---

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸€æ­¥ï¼šç‚¹å‡» Start æŒ‰é’®                                       â”‚
â”‚  - éªŒè¯é…ç½®ï¼ˆprompt, generator, evaluatorï¼‰                   â”‚
â”‚  - å¦‚æœå¯ç”¨äº† Inquiry Expansionï¼Œè°ƒç”¨ /expand API            â”‚
â”‚  - è‡ªåŠ¨åˆ‡æ¢åˆ° Retrieval é¢æ¿                                 â”‚
â”‚  - æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼š"Expanding query..."                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‹“å±•å®Œæˆï¼šæ˜¾ç¤ºæ—¶é—´è½´                                         â”‚
â”‚  - æ¸²æŸ“ QueryExpansionTimeline ç»„ä»¶                          â”‚
â”‚  - æ˜¾ç¤ºæ‰€æœ‰æ­¥éª¤ï¼ˆPhase, Step Name, VTK Modules, Descriptionï¼‰â”‚
â”‚  - ç”¨æˆ·å¯ç¼–è¾‘ä»»æ„æ­¥éª¤                                         â”‚
â”‚  - å¤±ç„¦è‡ªåŠ¨ä¿å­˜åˆ°å‰ç«¯çŠ¶æ€                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬äºŒæ­¥ï¼šç‚¹å‡» "Proceed to Retrieval" æŒ‰é’®                     â”‚
â”‚  - å‘é€ç¼–è¾‘åçš„æ‹“å±•æ•°æ®åˆ° /retrieval API                      â”‚
â”‚  - æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼š"Retrieving relevant examples..."          â”‚
â”‚  - ä½¿ç”¨ RAGAgent(use_v3=True) è¿›è¡Œçº¯ MongoDB æ£€ç´¢            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ£€ç´¢å®Œæˆï¼šæ˜¾ç¤ºæ£€ç´¢ç»“æœ                                       â”‚
â”‚  - æ¸²æŸ“ RetrievalResultsCard ç»„ä»¶                            â”‚
â”‚  - æ˜¾ç¤ºåŒ¹é…çš„ç¤ºä¾‹ï¼ˆtitle, description, relevance, keywordsï¼‰â”‚
â”‚  - æ˜¾ç¤º "Proceed to Generation" æŒ‰é’®                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸‰æ­¥ï¼šç‚¹å‡» "Proceed to Generation" æŒ‰é’®                    â”‚
â”‚  - ä½¿ç”¨æœ€ç»ˆçš„æ‹“å±•æ•°æ®å’Œæ£€ç´¢åçš„ prompt                        â”‚
â”‚  - è°ƒç”¨ /generate API ç”Ÿæˆä»£ç                                â”‚
â”‚  - æ˜¾ç¤ºç”Ÿæˆçš„ä»£ç                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### åç«¯ API ç«¯ç‚¹

#### 1. `/expand` - æç¤ºè¯æ‹“å±•ï¼ˆæ–°å¢ï¼‰

**è¯·æ±‚**ï¼š
```json
{
  "prompt": "Generate volume rendering with VTI file"
}
```

**å“åº”**ï¼š
```json
{
  "success": true,
  "analysis": [
    {
      "phase": "Data Loading",
      "step_name": "Load VTI file",
      "vtk_modules": ["vtkXMLImageDataReader"],
      "description": "Load volumetric data from VTI file..."
    }
  ]
}
```

#### 2. `/retrieval` - RAG æ£€ç´¢ï¼ˆå·²æ›´æ–°ï¼‰

**è¯·æ±‚**ï¼š
```json
{
  "analysis": [...],  // ç¼–è¾‘åçš„æ‹“å±•æ•°æ®
  "prompt": "..."
}
```

**å“åº”**ï¼š
```json
{
  "success": true,
  "final_prompt": "...",  // æ£€ç´¢å¢å¼ºåçš„ prompt
  "retrieval_results": [
    {
      "id": "...",
      "title": "...",
      "description": "...",
      "relevance": 0.95,
      "matched_keywords": [...]
    }
  ],
  "analysis": [...]
}
```

#### 3. `/generate` - ä»£ç ç”Ÿæˆï¼ˆå·²æœ‰ï¼‰

ä¿æŒä¸å˜ï¼Œä½†ç°åœ¨å¯ä»¥æ¥æ”¶ `expansionData` å’Œ `finalPrompt` å­—æ®µã€‚

---

### å‰ç«¯ç»„ä»¶çŠ¶æ€ç®¡ç†

#### LeftSidebar ç»„ä»¶çŠ¶æ€

```javascript
const workflowState = ref('idle');      // å·¥ä½œæµçŠ¶æ€
const isExpanding = ref(false);          // æ‹“å±•åŠ è½½çŠ¶æ€
const isRetrieving = ref(false);         // æ£€ç´¢åŠ è½½çŠ¶æ€
const isGenerating = ref(false);         // ç”ŸæˆåŠ è½½çŠ¶æ€
const queryExpansionData = ref([]);      // æ‹“å±•æ•°æ®
const updatedExpansionData = ref(null); // ç”¨æˆ·ç¼–è¾‘åçš„æ•°æ®
const finalPrompt = ref('');             // æ£€ç´¢åçš„æœ€ç»ˆ prompt
```

**çŠ¶æ€æµè½¬**ï¼š
```
idle â†’ (ç‚¹å‡» Start) â†’ expanding â†’ expanded â†’ 
(ç‚¹å‡» Proceed to Retrieval) â†’ retrieving â†’ retrieved â†’
(ç‚¹å‡» Proceed to Generation) â†’ generating â†’ generated
```

#### QueryExpansionTimeline ç»„ä»¶

æ–°å¢ Propsï¼š
```javascript
isLoading: Boolean          // æ˜¯å¦æ˜¾ç¤ºåŠ è½½çŠ¶æ€
loadingText: String         // åŠ è½½æ–‡æœ¬
```

---

## ğŸ¨ UI/UX æ”¹è¿›

### 1. Start æŒ‰é’®
- **å›¾æ ‡**ï¼š`mdi-rocket-launch-outline`
- **æ–‡æœ¬**ï¼šStartï¼ˆæ›¿ä»£åŸæ¥çš„ Generateï¼‰
- **é¢œè‰²**ï¼š`#4a5258`ï¼ˆä¿æŒä¸å˜ï¼‰

### 2. åŠ è½½çŠ¶æ€

#### æ‹“å±•åŠ è½½
```html
<v-progress-circular
  indeterminate
  size="64"
  width="6"
  color="primary"
></v-progress-circular>
<p>Expanding query...</p>
```

#### æ£€ç´¢åŠ è½½
```html
<v-progress-circular
  indeterminate
  size="48"
  width="5"
  color="primary"
></v-progress-circular>
<p>Retrieving relevant examples...</p>
```

### 3. å·¥ä½œæµçŠ¶æ€æŒ‡ç¤ºå™¨

| çŠ¶æ€ | é¢œè‰² | æ–‡æœ¬ |
|------|------|------|
| idle | grey | Ready |
| expanded | success | Query Expanded - Ready for Retrieval |
| retrieved | primary | Retrieved - Ready for Generation |
| generated | info | Code Generated |

---

## âœ… Retriever V3 ç¡®è®¤

### é—®é¢˜è¯Šæ–­

ä»ç»ˆç«¯è¾“å‡ºçœ‹åˆ°çš„ FAISS åŠ è½½ä¿¡æ¯æ¥è‡ªäºæ—§çš„ retriever_v2ã€‚

### è§£å†³æ–¹æ¡ˆ

å·²ç¡®ä¿æ‰€æœ‰ä»£ç éƒ½ä½¿ç”¨ `RAGAgent(use_v3=True)`ï¼š

1. **app.py** - ç¬¬ 114 è¡Œå’Œç¬¬ 147 è¡Œ
2. **LeftSidebar.vue** - handleProceedToRetrieval æ–¹æ³•

### éªŒè¯æ­¥éª¤

å¯åŠ¨åº”ç”¨åï¼Œæ£€æŸ¥æ§åˆ¶å°æ—¥å¿—ï¼š
```
[RAGAgent] ä½¿ç”¨ VTKSearcherV3 (å…³é”®è¯æ£€ç´¢)
```

**ä¸åº”è¯¥çœ‹åˆ°**ï¼š
```
æ£€æµ‹åˆ°FAISSç´¢å¼•æœªåŠ è½½
FAISS ç´¢å¼•å·²ä» xxx åŠ è½½
```

å¦‚æœä»ç„¶çœ‹åˆ° FAISS ç›¸å…³æ—¥å¿—ï¼Œè¯´æ˜æŸå¤„è¿˜åœ¨è°ƒç”¨ v2ï¼Œéœ€è¦è¿›ä¸€æ­¥æ’æŸ¥ã€‚

---

## ğŸ§ª æµ‹è¯•æµç¨‹

### 1. å¯åŠ¨åº”ç”¨

```bash
# åç«¯
python app.py

# å‰ç«¯ï¼ˆæ–°çª—å£ï¼‰
cd front
npm run dev
```

### 2. æµ‹è¯•å®Œæ•´å·¥ä½œæµ

#### Step 1: é…ç½®
- å‹¾é€‰ â˜‘ï¸ Inquiry Expansion
- å‹¾é€‰ â˜‘ï¸ RAG
- é€‰æ‹© Generator å’Œ Evaluator
- è¾“å…¥ Promptï¼š"Generate HTML with vtk.js to visualize volume rendering"

#### Step 2: Start
- ç‚¹å‡» **Start** æŒ‰é’®
- éªŒè¯ï¼šè‡ªåŠ¨åˆ‡æ¢åˆ° Retrieval é¢æ¿
- éªŒè¯ï¼šæ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- ç­‰å¾…æ‹“å±•å®Œæˆ

#### Step 3: æŸ¥çœ‹/ç¼–è¾‘æ‹“å±•ç»“æœ
- éªŒè¯ï¼šæ˜¾ç¤ºæ—¶é—´è½´ï¼ˆ4-6ä¸ªæ­¥éª¤ï¼‰
- å¯é€‰ï¼šç‚¹å‡»ä»»æ„æ­¥éª¤çš„ç¼–è¾‘æŒ‰é’®
- å¯é€‰ï¼šä¿®æ”¹ step_name æˆ– description
- å¯é€‰ï¼šç‚¹å‡»ä¿å­˜æŒ‰é’®

#### Step 4: è¿›å…¥æ£€ç´¢
- ç‚¹å‡» **Proceed to Retrieval** æŒ‰é’®
- éªŒè¯ï¼šæ˜¾ç¤ºæ£€ç´¢åŠ è½½åŠ¨ç”»
- ç­‰å¾…æ£€ç´¢å®Œæˆ
- éªŒè¯ï¼šæ˜¾ç¤ºæ£€ç´¢ç»“æœå¡ç‰‡

#### Step 5: ç”Ÿæˆä»£ç 
- ç‚¹å‡» **Proceed to Generation** æŒ‰é’®
- éªŒè¯ï¼šæ˜¾ç¤ºç”ŸæˆåŠ è½½çŠ¶æ€ï¼ˆå…¨å±€ overlayï¼‰
- ç­‰å¾…ç”Ÿæˆå®Œæˆ
- éªŒè¯ï¼šä»£ç æ˜¾ç¤ºåœ¨ä¸­é—´é¢„è§ˆåŒº

#### Step 6: æ£€æŸ¥æ—¥å¿—
æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œæ£€æŸ¥ï¼š
- âœ… æ˜¯å¦æœ‰ `[RAGAgent] ä½¿ç”¨ VTKSearcherV3`
- âŒ ä¸åº”è¯¥æœ‰ FAISS ç›¸å…³æ—¥å¿—

### 3. æµ‹è¯•å¼‚å¸¸æƒ…å†µ

#### ç©º Prompt
- æ¸…ç©º Prompt è¾“å…¥æ¡†
- ç‚¹å‡» Start
- éªŒè¯ï¼šæ˜¾ç¤ºé”™è¯¯æç¤º "Prompt cannot be empty"

#### æœªé€‰æ‹© Generator
- æ¸…ç©º Generator é€‰æ‹©
- ç‚¹å‡» Start
- éªŒè¯ï¼šæ˜¾ç¤ºé”™è¯¯æç¤º "Generator cannot be empty"

#### æœªå¯ç”¨ Inquiry Expansion
- å–æ¶ˆå‹¾é€‰ Inquiry Expansion
- ç‚¹å‡» Start
- éªŒè¯ï¼šç›´æ¥è¿›å…¥ç”Ÿæˆæµç¨‹ï¼ˆä¸æ˜¾ç¤ºæ‹“å±•é¢æ¿ï¼‰

---

## ğŸ“Š æ•°æ®æµè½¬å›¾

```
User Input
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  handleStart()                    â”‚
â”‚  - éªŒè¯é…ç½®                        â”‚
â”‚  - isExpanding = true             â”‚
â”‚  - åˆ‡æ¢åˆ° retrieval é¢æ¿           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /expand                     â”‚
â”‚  - è°ƒç”¨ analyze_query             â”‚
â”‚  - è¿”å›ç»“æ„åŒ–æ•°æ®                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  queryExpansionData = analysis    â”‚
â”‚  - isExpanding = false            â”‚
â”‚  - workflowState = 'expanded'     â”‚
â”‚  - æ¸²æŸ“æ—¶é—´è½´                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
ç”¨æˆ·å¯ç¼–è¾‘ï¼ˆupdatedExpansionDataï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  handleProceedToRetrieval()       â”‚
â”‚  - isRetrieving = true            â”‚
â”‚  - ä½¿ç”¨ç¼–è¾‘åçš„æ•°æ®                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /retrieval                  â”‚
â”‚  - RAGAgent(use_v3=True)          â”‚
â”‚  - MongoDB å…³é”®è¯æ£€ç´¢              â”‚
â”‚  - è¿”å› retrieval_results +       â”‚
â”‚    final_prompt                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  finalPrompt = final_prompt       â”‚
â”‚  - isRetrieving = false           â”‚
â”‚  - workflowState = 'retrieved'    â”‚
â”‚  - æ˜¾ç¤ºæ£€ç´¢ç»“æœ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  handleProceedToGeneration()      â”‚
â”‚  - isGenerating = true            â”‚
â”‚  - ä½¿ç”¨ finalPrompt               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /generate                   â”‚
â”‚  - ä½¿ç”¨æ£€ç´¢å¢å¼ºçš„ prompt           â”‚
â”‚  - ç”Ÿæˆä»£ç                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ˜¾ç¤ºç”Ÿæˆçš„ä»£ç                     â”‚
â”‚  - isGenerating = false           â”‚
â”‚  - workflowState = 'generated'    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: ä»ç„¶çœ‹åˆ° FAISS æ—¥å¿—
**å¯èƒ½åŸå› **ï¼š
- æŸå¤„ç›´æ¥å®ä¾‹åŒ–äº† `VTKSearcherV2` è€Œéé€šè¿‡ `RAGAgent`
- å¯¼å…¥è·¯å¾„é”™è¯¯

**æ’æŸ¥æ–¹æ³•**ï¼š
```bash
# æœç´¢æ‰€æœ‰ VTKSearcherV2 å®ä¾‹åŒ–
grep -r "VTKSearcherV2()" .

# æ£€æŸ¥æ˜¯å¦æœ‰ç›´æ¥å¯¼å…¥ retriever_v2 çš„åœ°æ–¹
grep -r "from RAG.retriever_v2 import" .
```

### Q2: æç¤ºè¯æ‹“å±•ä¸€ç›´åŠ è½½
**å¯èƒ½åŸå› **ï¼š
- åç«¯ `/expand` API é”™è¯¯
- ollama æœåŠ¡æœªå¯åŠ¨æˆ–æ¨¡å‹æœªåŠ è½½

**è§£å†³æ–¹æ³•**ï¼š
- æ£€æŸ¥åç«¯æ—¥å¿—
- æ£€æŸ¥ ollama æœåŠ¡çŠ¶æ€

### Q3: æ£€ç´¢è¿”å›ç©ºç»“æœ
**å¯èƒ½åŸå› **ï¼š
- MongoDB æœªè¿æ¥
- VTK modules åç§°ä¸åŒ¹é…

**è§£å†³æ–¹æ³•**ï¼š
- æ£€æŸ¥ MongoDB è¿æ¥çŠ¶æ€
- æŸ¥çœ‹åç«¯æ—¥å¿—ä¸­çš„æ£€ç´¢è¯¦æƒ…

### Q4: ç‚¹å‡» Start åæ²¡æœ‰ååº”
**å¯èƒ½åŸå› **ï¼š
- é…ç½®éªŒè¯å¤±è´¥
- ç½‘ç»œè¯·æ±‚è¢«æ‹¦æˆª

**è§£å†³æ–¹æ³•**ï¼š
- æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹é”™è¯¯
- æ£€æŸ¥ç½‘ç»œé¢æ¿

---

## ğŸ“ ä¿®æ”¹æ–‡ä»¶æ¸…å•

### åç«¯æ–‡ä»¶

1. **app.py**
   - æ–°å¢ `/expand` ç«¯ç‚¹
   - æ›´æ–° `/retrieval` ç«¯ç‚¹
   - ç¡®ä¿ä½¿ç”¨ `RAGAgent(use_v3=True)`

### å‰ç«¯æ–‡ä»¶

2. **LeftSidebar.vue**
   - Generate æŒ‰é’®æ”¹ä¸º Start
   - æ–°å¢ `handleStart()` æ–¹æ³•
   - æ–°å¢ `handleDirectGeneration()` æ–¹æ³•
   - æ›´æ–° `handleProceedToRetrieval()` å’Œ `handleProceedToGeneration()`
   - æ·»åŠ  `isExpanding`, `isRetrieving`, `isGenerating` çŠ¶æ€
   - æ·»åŠ æ£€ç´¢åŠ è½½åŠ¨ç”»

3. **QueryExpansionTimeline.vue**
   - æ–°å¢ `isLoading` å’Œ `loadingText` props
   - æ·»åŠ åŠ è½½çŠ¶æ€ UI

4. **home.vue**
   - æ›´æ–° `handleRetrievalComplete()` å¤„ç†å¯¹è±¡æ ¼å¼æ•°æ®

---

## ğŸ“ æ€»ç»“

æœ¬æ¬¡æ›´æ–°å®ç°äº†ï¼š

âœ… **åˆ†æ­¥å·¥ä½œæµ**ï¼šStart â†’ æ‹“å±• â†’ æ£€ç´¢ â†’ ç”Ÿæˆ
âœ… **åŠ è½½çŠ¶æ€**ï¼šæ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ¸…æ™°çš„åŠ è½½æç¤º
âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šè‡ªåŠ¨åˆ‡æ¢é¢æ¿ï¼Œæ¸…æ™°çš„çŠ¶æ€æŒ‡ç¤º
âœ… **æ•°æ®æµ**ï¼šå®Œæ•´çš„æ•°æ®ä¼ é€’å’ŒçŠ¶æ€ç®¡ç†
âœ… **Retriever V3**ï¼šç¡®ä¿ä½¿ç”¨çº¯ MongoDB æ£€ç´¢

æ ¸å¿ƒä¼˜åŠ¿ï¼š
- ğŸ¯ **æ­¥éª¤æ¸…æ™°**ï¼šç”¨æˆ·æ˜ç¡®çŸ¥é“å½“å‰åœ¨å“ªä¸€æ­¥
- â±ï¸ **åŠ è½½åé¦ˆ**ï¼šæ¯ä¸ªå¼‚æ­¥æ“ä½œéƒ½æœ‰åŠ è½½æç¤º
- âœï¸ **å¯ç¼–è¾‘**ï¼šæ‹“å±•ç»“æœå¯ä»¥éšæ—¶ä¿®æ”¹
- ğŸ”„ **çµæ´»**ï¼šæ”¯æŒè·³è¿‡æ‹“å±•å’Œæ£€ç´¢ç›´æ¥ç”Ÿæˆ

æŠ€æœ¯äº®ç‚¹ï¼š
- ğŸ“¡ **ç‹¬ç«‹APIç«¯ç‚¹**ï¼šæ‹“å±•ã€æ£€ç´¢ã€ç”Ÿæˆåˆ†ç¦»
- ğŸ—ï¸ **çŠ¶æ€æœº**ï¼šæ¸…æ™°çš„å·¥ä½œæµçŠ¶æ€ç®¡ç†
- ğŸ¨ **ç¾è§‚UI**ï¼šåŠ è½½åŠ¨ç”»å’ŒçŠ¶æ€æŒ‡ç¤ºå™¨
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„éªŒè¯å’Œé”™è¯¯æç¤º
