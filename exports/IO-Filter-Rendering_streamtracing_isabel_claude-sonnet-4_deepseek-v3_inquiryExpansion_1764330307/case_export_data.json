{
  "path": "IO-Filter-Rendering\\streamtracing\\isabel\\description.txt",
  "name": "description.txt",
  "prompt": "Generate an HTML page using vtk.js to visualize the Isabel dataset with streamline rendering.\n\nLoad the dataset from: http://127.0.0.1:5000/dataset/isabel.vti\n\nUse the \"Velocity\" array as the vector field for streamlines\n\nGenerate seed points at the center of the dataset with sufficient density to cover the domain\n\nCompute streamlines following the velocity field\n\nRender streamlines in cyan ([0, 1, 1]) with a specified line width\n\nRender a dataset outline in red ([1, 0, 0]) with a specified line width",
  "ground_truth": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js streamtracing</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n\n    <script>\n        const vtkOutlineFilter = vtk.Filters.General.vtkOutlineFilter;\n        const vtkPlaneSource = vtk.Filters.Sources.vtkPlaneSource;\n        const vtkImageStreamline = vtk.Filters.General.vtkImageStreamline;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n\n        const Representation = vtk.Rendering.Core.vtkProperty.Representation;\n        const vtkDataArray = vtk.Common.Core.vtkDataArray;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n        const macro = vtk.macro;\n\n        const vtkXMLImageDataReader = vtk.IO.XML.vtkXMLImageDataReader;\n\n\n        // ----------------------------------------------------------------------------\n        // Standard rendering code setup\n        // ----------------------------------------------------------------------------\n\n        const fullScreenRenderer = vtk.Rendering.Misc.vtkFullScreenRenderWindow.newInstance({\n            background: [1,1,1],\n        });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // ----------------------------------------------------------------------------\n        // Example code\n        // ----------------------------------------------------------------------------\n\n        function addRepresentation(name, filter, props = {}) {\n            const mapper = vtkMapper.newInstance();\n            mapper.setInputConnection(filter.getOutputPort());\n\n            const actor = vtkActor.newInstance();\n            actor.setMapper(mapper);\n            actor.getProperty().set(props);\n            renderer.addActor(actor);\n        }\n\n        // ----------------------------------------------------------------------------\n\n        // load testing data\n        const reader = vtkXMLImageDataReader.newInstance();\n        reader.setUrl('http://127.0.0.1:5000/dataset/isabel.vti').then(() => {\n            reader.loadData().then(() => {\n                const imageData = reader.getOutputData(0);\n                const velocityArray = imageData.getPointData().getArrayByName('Velocity');\n\n                //get bounds for data sets\n                //set plane according to bounds\n                const bounds = imageData.getBounds()\n\n                const pointSource = vtk.Filters.Sources.vtkPointSource.newInstance();\n                pointSource.setNumberOfPoints(1000);  // adjust for density\n                pointSource.setCenter(\n                    (bounds[0] + bounds[1]) / 2,\n                    (bounds[2] + bounds[3]) / 2,\n                    (bounds[4] + bounds[5]) / 2\n                );\n                pointSource.setRadius(Math.max(\n                    bounds[1] - bounds[0],\n                    bounds[3] - bounds[2],\n                    bounds[5] - bounds[4],\n                ) / 2);\n\n                console.log(\"bounds\", bounds)\n\n                const streamline = vtkImageStreamline.newInstance();\n                streamline.setInputData(imageData);  // velocity field\n                streamline.setInputConnection(pointSource.getOutputPort(), 1); // seeds\n\n                streamline.set({\n                    maximumNumberOfSteps: 1000,\n                    integrationStep: 0.5,\n                    // terminalSpeed: 1e-3,\n                    // integratorType: 1,         // RK4\n                    // integrationDirection: 2,   // both\n                });\n\n\n                const outlineFilter = vtkOutlineFilter.newInstance();\n                outlineFilter.setInputData(imageData);\n\n                addRepresentation('streamLine', streamline, {\n                    diffuseColor: [0.4, 0.7, 0.7],\n                    lineWidth: 5,\n                });\n                addRepresentation('outline', outlineFilter, {\n                    diffuseColor: [0.6, 0.2, 0.2],\n                    lineWidth: 3,\n                });\n                // addRepresentation('seed', pointSource, {\n                //     representation: Representation.POINTS,\n                //     pointSize: 10,\n                // });\n\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n\n\n    </script>\n\n</body>\n\n</html>",
  "generated_code": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js Isabel Dataset Streamline Visualization</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n\n    <script type=\"text/javascript\" src=\"https://unpkg.com/@babel/polyfill@7.0.0/dist/polyfill.js\"></script>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        // Initialize the full screen render window\n        const fullScreenRenderer = vtk.Rendering.Misc.vtkFullScreenRenderWindow.newInstance({\n            background: [0, 0, 0],\n        });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // Create data reader for the Isabel dataset\n        const reader = vtk.IO.Core.vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n\n        // Load the Isabel dataset from the specified URL\n        reader\n            .setUrl('http://127.0.0.1:5000/dataset/isabel.vti', { loadData: true })\n            .then(() => {\n                const imageData = reader.getOutputData();\n                \n                // Get dataset bounds to generate seed points at center\n                const bounds = imageData.getBounds();\n                const centerX = (bounds[0] + bounds[1]) / 2;\n                const centerY = (bounds[2] + bounds[3]) / 2;\n                const centerZ = (bounds[4] + bounds[5]) / 2;\n                \n                // Calculate dimensions for seed point distribution\n                const xRange = bounds[1] - bounds[0];\n                const yRange = bounds[3] - bounds[2];\n                const zRange = bounds[5] - bounds[4];\n                \n                // Create seed points with sufficient density around the center\n                const seeds = vtk.Common.DataModel.vtkPolyData.newInstance();\n                const points = vtk.Common.Core.vtkPoints.newInstance();\n                const verts = vtk.Common.Core.vtkCellArray.newInstance();\n                \n                // Generate a grid of seed points centered in the domain\n                const seedDensity = 5; // Number of seeds per dimension\n                const seedSpacing = Math.min(xRange, yRange, zRange) / (seedDensity * 2);\n                \n                let pointId = 0;\n                for (let i = -seedDensity/2; i <= seedDensity/2; i++) {\n                    for (let j = -seedDensity/2; j <= seedDensity/2; j++) {\n                        for (let k = -seedDensity/2; k <= seedDensity/2; k++) {\n                            const x = centerX + i * seedSpacing;\n                            const y = centerY + j * seedSpacing;\n                            const z = centerZ + k * seedSpacing;\n                            \n                            // Check if point is within bounds\n                            if (x >= bounds[0] && x <= bounds[1] &&\n                                y >= bounds[2] && y <= bounds[3] &&\n                                z >= bounds[4] && z <= bounds[5]) {\n                                points.insertNextPoint([x, y, z]);\n                                verts.insertNextCell([pointId]);\n                                pointId++;\n                            }\n                        }\n                    }\n                }\n                \n                seeds.setPoints(points);\n                seeds.setVerts(verts);\n                \n                // Create streamline filter\n                const streamline = vtk.Filters.FlowField.vtkStreamTracer.newInstance({\n                    integrationDirection: vtk.Filters.FlowField.vtkStreamTracer.IntegrationDirection.BOTH,\n                    integrationStepUnit: vtk.Filters.FlowField.vtkStreamTracer.IntegrationStepUnit.LENGTH_UNIT,\n                    initialIntegrationStep: 0.1,\n                    maximumIntegrationStep: 1.0,\n                    maximumNumberOfSteps: 2000,\n                    maximumPropagation: 100.0,\n                });\n                \n                // Set the vector field input (Isabel dataset with \"Velocity\" array)\n                streamline.setInputData(imageData);\n                streamline.setInputArrayToProcess(0, 'Velocity', 'PointData', 'Vector');\n                \n                // Set seed points as the source\n                streamline.setSourceData(seeds);\n                \n                // Create mapper and actor for streamlines\n                const streamlineMapper = vtk.Rendering.Core.vtkMapper.newInstance();\n                streamlineMapper.setInputConnection(streamline.getOutputPort());\n                \n                const streamlineActor = vtk.Rendering.Core.vtkActor.newInstance();\n                streamlineActor.setMapper(streamlineMapper);\n                \n                // Set streamline color to cyan [0, 1, 1] and line width\n                streamlineActor.getProperty().setColor(0, 1, 1);\n                streamlineActor.getProperty().setLineWidth(2);\n                \n                // Create outline filter for dataset bounds\n                const outline = vtk.Filters.General.vtkOutlineFilter.newInstance();\n                outline.setInputData(imageData);\n                \n                // Create mapper and actor for outline\n                const outlineMapper = vtk.Rendering.Core.vtkMapper.newInstance();\n                outlineMapper.setInputConnection(outline.getOutputPort());\n                \n                const outlineActor = vtk.Rendering.Core.vtkActor.newInstance();\n                outlineActor.setMapper(outlineMapper);\n                \n                // Set outline color to red [1, 0, 0] and line width\n                outlineActor.getProperty().setColor(1, 0, 0);\n                outlineActor.getProperty().setLineWidth(2);\n                outlineActor.getProperty().setRepresentationToWireframe();\n                \n                // Add actors to renderer\n                renderer.addActor(streamlineActor);\n                renderer.addActor(outlineActor);\n                \n                // Reset camera and render\n                renderer.resetCamera();\n                renderWindow.render();\n                \n                // Store references for debugging\n                window.reader = reader;\n                window.streamline = streamline;\n                window.streamlineMapper = streamlineMapper;\n                window.streamlineActor = streamlineActor;\n                window.outline = outline;\n                window.outlineMapper = outlineMapper;\n                window.outlineActor = outlineActor;\n                window.renderer = renderer;\n                window.renderWindow = renderWindow;\n            })\n            .catch((error) => {\n                console.error('Error loading dataset:', error);\n            });\n    </script>\n\n</body>\n\n</html>",
  "generator_prompt": "Please use vtkjs to generate visualization code. The code should be in the form of a complete code wrapped only in HTML tags. Please add your thinking process as comments in the code to make it easier to understand the code logic.\n\nIn the code, use `<script src=\"https://unpkg.com/vtk.js\"></script>` as the library for visualization to implement the visualization function.\nPlease follow the following rules:\n1. The content of the answer is HTML code with vtkjs script(start from <!DOCTYPE html>), and if there is any explanation, it should be given in the form of comments.\n2. If the sample code is relevant to the user's requirements, implement the user's requirements based on the sample code.\n3. The answer should be based on the provided sample information, and do not fabricate functions that do not exist. \nPlease implement the code strictly according to the specific requirements of the user in the `<QUESTION></QUESTION>` tag. Ensure that the code logic is clear and straightforward, and generate the visualization-related code completely in accordance with the syntax specifications of vtkjs. \n<QUESTION>__QUESTION__</QUESTION>\n\n",
  "final_prompt": "\n    Generate only the HTML code without any additional text or markdown formatting.\n    User Requirements:\n    Generate an HTML page using vtk.js to visualize the Isabel dataset with streamline rendering.\n\nLoad the dataset from: http://127.0.0.1:5000/dataset/isabel.vti\n\nUse the \"Velocity\" array as the vector field for streamlines\n\nGenerate seed points at the center of the dataset with sufficient density to cover the domain\n\nCompute streamlines following the velocity field\n\nRender streamlines in cyan ([0, 1, 1]) with a specified line width\n\nRender a dataset outline in red ([1, 0, 0]) with a specified line width\n\n    Relevant VTK.js Examples:\n    示例 1:\n描述: Loads 3D volume data, writes it to a binary XML format using `vtkXMLImageDataWriter`, reads it back with `vtkXMLImageDataReader`, and visualizes it\nVTK.js 模块: ['vtk.IO.XML.vtkXMLImageDataReader.newInstance', 'vtk.Common.DataModel.vtkPiecewiseFunction.newInstance', 'vtk.IO.Core.vtkHttpDataSetReader.newInstance', 'vtk.IO.XML.vtkXMLImageDataWriter.newInstance', 'vtk.IO.XML.vtkXMLWriter.FormatTypes.BINARY', 'vtk.Rendering.Core.vtkColorTransferFunction.newInstance', 'vtk.Rendering.Core.vtkVolume.newInstance', 'vtk.Rendering.Core.vtkVolumeMapper.newInstance', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow.newInstance']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js XMLImageDataWriter</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n\n    <script type=\"text/javascript\" src=\"https://unpkg.com/@babel/polyfill@7.0.0/dist/polyfill.js\"></script>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n\n        // ----------------------------------------------------------------------------\n        // Standard rendering code setup\n        // ----------------------------------------------------------------------------\n\n        const dataPath = 'http://kitware.github.io/vtk-js/data/volume/headsq.vti';\n        const fullScreenRenderer = vtk.Rendering.Misc.vtkFullScreenRenderWindow.newInstance();\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        const reader = vtk.IO.Core.vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n\n        const writer = vtk.IO.XML.vtkXMLImageDataWriter.newInstance();\n        writer.setFormat(vtk.IO.XML.vtkXMLWriter.FormatTypes.BINARY);\n        writer.setInputConnection(reader.getOutputPort());\n\n        const writerReader = vtk.IO.XML.vtkXMLImageDataReader.newInstance();\n\n        reader\n            .setUrl(dataPath, { loadData: true })\n            .then(() => {\n                const fileContents = writer.write(reader.getOutputData());\n\n                // Try to read it back.\n                const textEncoder = new TextEncoder();\n                writerReader.parseAsArrayBuffer(textEncoder.encode(fileContents));\n                renderer.resetCamera();\n                renderWindow.render();\n\n                const blob = new Blob([fileContents], { type: 'text/plain' });\n                const a = window.document.createElement('a');\n                a.href = window.URL.createObjectURL(blob, { type: 'text/plain' });\n                a.download = 'headsq.vti';\n                a.text = 'Download';\n                a.style.position = 'absolute';\n                a.style.left = '50%';\n                a.style.bottom = '10px';\n                document.body.appendChild(a);\n                a.style.background = 'white';\n                a.style.padding = '5px';\n            });\n\n        const actor = vtk.Rendering.Core.vtkVolume.newInstance();\n        const mapper = vtk.Rendering.Core.vtkVolumeMapper.newInstance();\n        mapper.setSampleDistance(1.1);\n        actor.setMapper(mapper);\n\n        mapper.setInputConnection(writerReader.getOutputPort());\n\n        // create color and opacity transfer functions\n        const ctfun = vtk.Rendering.Core.vtkColorTransferFunction.newInstance();\n        ctfun.addRGBPoint(200.0, 1.0, 1.0, 1.0);\n        ctfun.addRGBPoint(2000.0, 0.0, 0.0, 0.0);\n        const ofun = vtk.Common.DataModel.vtkPiecewiseFunction.newInstance();\n        ofun.addPoint(200.0, 0.0);\n        ofun.addPoint(1200.0, 0.2);\n        ofun.addPoint(4000.0, 0.4);\n        actor.getProperty().setRGBTransferFunction(0, ctfun);\n        actor.getProperty().setScalarOpacity(0, ofun);\n        actor.getProperty().setScalarOpacityUnitDistance(0, 4.5);\n        // actor.getProperty().setInterpolationTypeToNearest();\n        // actor.getProperty().setInterpolationTypeToFastLinear();\n        actor.getProperty().setInterpolationTypeToLinear();\n\n        renderer.addActor(actor);\n\n        window.writer = writer;\n        window.writerReader = writerReader;\n        window.mapper = mapper;\n        window.actor = actor;\n        window.renderer = renderer;\n        window.renderWindow = renderWindow;\n\n    </script>\n\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 2:\n描述: Loads 3D polydata, writes it to a string using `vtkXMLPolyDataWriter`, reads it back with `vtkXMLPolyDataReader`, and renders it, allowing download of the generated VTP file.\nVTK.js 模块: ['vtk.IO.Core.vtkHttpDataSetReader', 'vtk.IO.XML.vtkXMLPolyDataReader', 'vtk.IO.XML.vtkXMLPolyDataWriter', 'vtk.IO.XML.vtkXMLWriter', 'vtk.Rendering.Core.vtkActor.newInstance', 'vtk.Rendering.Core.vtkMapper.newInstance', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js XMLImagePolyDataWriter</title>\n    <!-- <link rel=\"stylesheet\" href=\"https://kit.fontawesome.com/419a5ebb56.css\" crossorigin=\"anonymous\"> -->\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n\n    <script type=\"text/javascript\" src=\"https://unpkg.com/@babel/polyfill@7.0.0/dist/polyfill.js\"></script>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const mapper = vtk.Rendering.Core.vtkMapper.newInstance();\n        const actor = vtk.Rendering.Core.vtkActor.newInstance();\n        const fullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const httpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n        const xmlPolyDataWriter = vtk.IO.XML.vtkXMLPolyDataWriter;\n        const xmlPolyDataReader = vtk.IO.XML.vtkXMLPolyDataReader;\n        const xmlWriter = vtk.IO.XML.vtkXMLWriter;\n        // Create instances using namespace paths\n        const fullScreenRenderer = fullScreenRenderWindow.newInstance();\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n        const reader = httpDataSetReader.newInstance({ fetchGzip: true });\n\n        const writer = xmlPolyDataWriter.newInstance();\n        writer.setFormat(xmlWriter.FormatTypes.BINARY);\n        writer.setInputConnection(reader.getOutputPort());\n\n        const writerReader = xmlPolyDataReader.newInstance();\n\n        reader.setUrl(`http://kitware.github.io/vtk-js/data/cow.vtp`, { loadData: true }).then(() => {\n            const fileContents = writer.write(reader.getOutputData());\n\n            // Try to read it back.\n            const textEncoder = new TextEncoder();\n            writerReader.parseAsArrayBuffer(textEncoder.encode(fileContents));\n            renderer.resetCamera();\n            renderWindow.render();\n\n            const blob = new Blob([fileContents], { type: 'text/plain' });\n            const a = window.document.createElement('a');\n            a.href = window.URL.createObjectURL(blob, { type: 'text/plain' });\n            a.download = 'cow.vtp';\n            a.text = 'Download';\n            a.style.position = 'absolute';\n            a.style.left = '50%';\n            a.style.bottom = '10px';\n            document.body.appendChild(a);\n            a.style.background = 'white';\n            a.style.padding = '5px';\n        });\n\n        actor.setMapper(mapper);\n\n        mapper.setInputConnection(writerReader.getOutputPort());\n\n        renderer.addActor(actor);\n\n        window.writer = writer;\n        window.writerReader = writerReader;\n        window.mapper = mapper;\n        window.actor = actor;\n        window.renderer = renderer;\n        window.renderWindow = renderWindow;\n\n\n    </script>\n\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 3:\n描述: Loads and visualizes 3D elevation data from a CSV, applying a texture image, using `vtkElevationReader` and `vtkMapper`.\n\nVTK.js 模块: ['vtk.IO.Misc.vtkElevationReader.newInstance', 'vtk.Rendering.Core.vtkActor.newInstance', 'vtk.Rendering.Core.vtkMapper.newInstance', 'vtk.Rendering.Core.vtkTexture.newInstance', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow.newInstance']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js ElevationReader</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n\n    <script type=\"text/javascript\" src=\"https://unpkg.com/@babel/polyfill@7.0.0/dist/polyfill.js\"></script>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n\n\n        const imagePath = 'http://kitware.github.io/vtk-js/data/elevation/dem.jpg';\n        // const imagePath = './dem.jpg'\n        const dataPath = 'http://kitware.github.io/vtk-js/data/elevation/dem.csv';\n        const fullScreenRenderer = vtk.Rendering.Misc.vtkFullScreenRenderWindow.newInstance({\n            background: [0, 0, 0],\n        });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n        const reader = vtk.IO.Misc.vtkElevationReader.newInstance({\n            xSpacing: 0.01568,\n            ySpacing: 0.01568,\n            zScaling: 0.06666,\n        });\n        const mapper = vtk.Rendering.Core.vtkMapper.newInstance();\n        const actor = vtk.Rendering.Core.vtkActor.newInstance();\n\n        mapper.setInputConnection(reader.getOutputPort());\n        actor.setMapper(mapper);\n\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n\n        // Download and apply Texture\n        const img = new Image();\n        img.src = imagePath;\n        //Add crossorigin=\"anonymous\" to avoid CORS errors\n        img.crossOrigin = \"anonymous\"\n        img.onload = function textureLoaded() {\n            const texture = vtk.Rendering.Core.vtkTexture.newInstance();\n            texture.setInterpolate(true);\n            texture.setImage(img);\n            actor.addTexture(texture);\n            renderWindow.render();\n        };\n\n        // Download elevation and render when ready\n        reader.setUrl(dataPath).then(() => {\n            renderer.resetCamera();\n            renderWindow.render();\n        });\n\n        window.reader = reader;\n        window.mapper = mapper;\n        window.actor = actor;\n        window.renderer = renderer;\n        window.renderWindow = renderWindow;\n\n    </script>\n\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 4:\n描述: Loads and visualizes a 3D polygonal data file (`test_cone.vtp`) using `vtkXMLPolyDataReader` and `vtkMapper`.\n\nVTK.js 模块: ['vtk.IO.XML.vtkXMLPolyDataReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js loading poly data, need to start by live server</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkXMLPolyDataReader = vtk.IO.XML.vtkXMLPolyDataReader;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n\n        // crete the render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // load the vtp data locally\n        const reader = vtkXMLPolyDataReader.newInstance();\n        // set url and load the data\n        reader.setUrl('../datasets/test_cone.vtp').then(() => {\n            reader.loadData().then(() => {\n                // assign data to actor\n                const mapper = vtkMapper.newInstance();\n                console.log(reader.getOutputData(0))\n                mapper.setInputData(reader.getOutputData(0));\n                const actor = vtkActor.newInstance();\n                actor.setMapper(mapper);\n\n                //  adding actor to render and render the data\n                renderer.addActor(actor);\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n\n</html>\n\n\n            ",
  "evaluator_prompt": "# Role\n\nYou are an expert Evaluator for vtk.js and web-based scientific visualization. Your task is to compare the [GENERATED_CODE] against the [GROUND_TRUTH] and evaluate it based on specific dimensions.\n\n# Input Data\n\n## Ground Truth Code:\n\n[GROUND_TRUTH]\n\n## Generated Code:\n\n[GENERATED_CODE]\n\n# Evaluation Criteria & Rubric (0.0 to 1.0)\n\nPlease evaluate the generated code based on the following 3 dimensions. \n\n1. **Functionality & Completeness (Task Completion)**: \n   - Does the code implement the same visualization pipeline as the ground truth? (e.g., correct readers, mappers, filters).\n   - Are critical elements present (e.g., color transfer functions, full-screen rendering)?\n   - Score 1.0 if logic is identical; lower if steps are missing.\n\n2. **Visual Fidelity (Visual Quality)**:\n   - Based on the code logic, will the visual output look similar to the ground truth?\n   - Check camera parameters, background colors, and opacity transfer functions.\n   - Check if the correct data arrays (scalars/vectors) are selected for coloring.\n\n3. **Code Quality & Maintainability**:\n   - Is the code readable, well-structured, and using vtk.js best practices?\n   - Is the variable naming clear?\n\n# Response Format\n\nYou must output the evaluation in the following Strict XML format. Do not use Markdown block quotes.\n\n<Evaluation>\n    <Dimension name=\"Functionality\">\n        <Score>[SCORE_FLOAT]</Score>\n        <Reason>[BRIEF_REASONING]</Reason>\n    </Dimension>\n    <Dimension name=\"VisualQuality\">\n        <Score>[SCORE_FLOAT]</Score>\n        <Reason>[BRIEF_REASONING]</Reason>\n    </Dimension>\n    <Dimension name=\"CodeQuality\">\n        <Score>[SCORE_FLOAT]</Score>\n        <Reason>[BRIEF_REASONING]</Reason>\n    </Dimension>\n    <Summary>\n        <OverallScore>[AVERAGE_SCORE]</OverallScore>\n        <Critique>[ONE_SENTENCE_SUMMARY]</Critique>\n    </Summary>\n</Evaluation>",
  "generator": "claude-sonnet-4",
  "evaluator": "deepseek-v3",
  "score": "0.8",
  "workflow": {
    "inquiryExpansion": true,
    "rag": true
  },
  "eval_id": "1764330307",
  "eval_user": "test",
  "export_time": null,
  "console_output": null,
  "eval_time": "2025-11-28 19:45:07",
  "evaluator_evaluation": "<Evaluation>\n    <Dimension name=\"Functionality\">\n        <Score>0.8</Score>\n        <Reason>The generated code implements the same visualization pipeline with streamlines and outlines, but uses a different reader (vtkHttpDataSetReader instead of vtkXMLImageDataReader) and a different streamline filter (vtkStreamTracer instead of vtkImageStreamline). Seeding strategy is also different (grid vs spherical distribution).</Reason>\n    </Dimension>\n    <Dimension name=\"VisualQuality\">\n        <Score>0.7</Score>\n        <Reason>Visual output should be similar but will differ in streamline appearance due to different seeding and filter parameters. Color choices are slightly different (cyan vs teal, red vs dark red). Background color is black instead of white.</Reason>\n    </Dimension>\n    <Dimension name=\"CodeQuality\">\n        <Score>0.9</Score>\n        <Reason>Code is well-structured with clear variable naming and follows vtk.js best practices. Includes better error handling and debug references.</Reason>\n    </Dimension>\n    <Summary>\n        <OverallScore>0.8</OverallScore>\n        <Critique>The generated code implements an equivalent visualization with some technical differences, producing a similar but not identical output with improved code structure.</Critique>\n    </Summary>\n</Evaluation>",
  "options": null,
  "analysis": "Data Loading — Load the dataset from 'http://127.0.0.1:5000/dataset/isabel.vti' using vtkXMLImageDataReader.\nData Processing — Extract the 'Velocity' array as the vector field for streamline computation using vtkCalculator to ensure it is available for streamlines.\nSeed Generation — Generate seed points at the center of the dataset with sufficient density to cover the domain using vtkPointSource or similar, ensuring uniform distribution across the volume.\nStreamline Computation — Compute streamlines following the velocity field using vtkStreamTracer with the generated seed points and the Velocity vector field.\nVisualization Setup — Render streamlines in cyan ([0, 1, 1]) using vtkGlyph3DMapper or vtkTubeFilter with a specified line width (e.g., 2) and assign a color transfer function to the streamlines.\nOutline Rendering — Render a dataset outline in red ([1, 0, 0]) using vtkOutlineFilter applied to the original image data and map it with a line width (e.g., 2).\nRendering — Configure the render window and add both the streamline and outline actors to the scene for visualization.",
  "retrieval_results": [
    {
      "id": 299933080,
      "title": "Example 1",
      "description": "Loads 3D volume data, writes it to a binary XML format using `vtkXMLImageDataWriter`, reads it back with `vtkXMLImageDataReader`, and visualizes it",
      "relevance": 0.8844626545906067
    },
    {
      "id": 144437569,
      "title": "Example 2",
      "description": "Loads 3D polydata, writes it to a string using `vtkXMLPolyDataWriter`, reads it back with `vtkXMLPolyDataReader`, and renders it, allowing download of the generated VTP file.",
      "relevance": 0.5893989205360413
    },
    {
      "id": 2054430029,
      "title": "Example 3",
      "description": "Loads and visualizes 3D elevation data from a CSV, applying a texture image, using `vtkElevationReader` and `vtkMapper`.\n",
      "relevance": 0.5820056796073914
    },
    {
      "id": 777604084,
      "title": "Example 4",
      "description": "Loads and visualizes a 3D polygonal data file (`test_cone.vtp`) using `vtkXMLPolyDataReader` and `vtkMapper`.\n",
      "relevance": 0.5743261575698853
    }
  ]
}