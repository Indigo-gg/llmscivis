{
  "path": "IO-Filter-Rendering\\cutter\\rotor\\description.txt",
  "name": "description.txt",
  "prompt": "Generate HTML with vtk.js to visualize sliced rotor data\n\nLoad from http://127.0.0.1:5000/dataset/rotor.vti\n\nProcessing:\n- Slice ：Set as active scalar \"Pressure\"\n- Applies a Y-axis slice at 80% depth (setSlice, setSlicingMode).\nVisualization:\n- Maps pressure values to colors (blue→white→red gradient) and opacity (full opacity).\n- UI: Adds an orientation marker (XYZ axes) for spatial reference.\n6. No GUI controls required",
  "ground_truth": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Rotor Dataset Cutting Rendering</title>\n    <style>\n        body,\n        html {\n            margin: 0;\n            padding: 0;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n\n        #renderer {\n            width: 100%;\n            height: 100%;\n        }\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n        const vtkXMLImageDataReader = vtk.IO.XML.vtkXMLImageDataReader;\n        const vtkPlane = vtk.Common.DataModel.vtkPlane;\n        const vtkCutter = vtk.Filters.Core.vtkCutter;\n        const vtkColorTransferFunction = vtk.Rendering.Core.vtkColorTransferFunction;\n\n        const fullScreenRenderWindow = vtkFullScreenRenderWindow.newInstance({\n            background: [0.1, 0.1, 0.1],\n        });\n        const renderWindow = fullScreenRenderWindow.getRenderWindow();\n        const renderer = fullScreenRenderWindow.getRenderer();\n\n        const reader = vtkXMLImageDataReader.newInstance();\n        reader.setUrl('http://127.0.0.1:5000/dataset/rotor_simplified.vti').then(() => {\n            reader.loadData().then(() => {\n                const imageData = reader.getOutputData(0);\n                imageData.getPointData().setActiveScalars('Pressure');\n\n                const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;\n                const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n\n                const imageMapper = vtkImageMapper.newInstance();\n                imageMapper.setInputData(imageData);\n                const dims = imageData.getDimensions();\n                imageMapper.setSlice(dims[1] * 0.8);\n                imageMapper.setSlicingMode(1); //(0:X, 1:Y, 2:Z)\n\n                const pressureArray = imageData.getPointData().getArrayByName('Pressure');\n                const [pMin, pMax] = pressureArray.getRange();\n                const colorTransferFunction = vtkColorTransferFunction.newInstance();\n                colorTransferFunction.addRGBPoint(pMin, 0.0, 0.0, 0.8);\n                colorTransferFunction.addRGBPoint((pMin + pMax) / 2, 1.0, 1.0, 1.0);\n                colorTransferFunction.addRGBPoint(pMax, 0.8, 0.0, 0.0);\n\n                // Add opacity transfer function\n                const vtkPiecewiseFunction = vtk.Common.DataModel.vtkPiecewiseFunction;\n                const opacityFunction = vtkPiecewiseFunction.newInstance();\n                opacityFunction.addPoint(pMin, 1.0);\n                opacityFunction.addPoint(pMax, 1.0);\n\n                const imageSlice = vtkImageSlice.newInstance();\n                imageSlice.setMapper(imageMapper);\n                imageSlice.getProperty().setRGBTransferFunction(0, colorTransferFunction);\n                imageSlice.getProperty().setPiecewiseFunction(0, opacityFunction);  // Set opacity function\n                imageSlice.getProperty().setScalarOpacity(0, opacityFunction);      // Set scalar opacity\n                imageSlice.getProperty().setUseLookupTableScalarRange(true);\n\n                renderer.addActor(imageSlice);\n\n                const axes = vtk.Rendering.Core.vtkAxesActor.newInstance();\n                const widget = vtk.Interaction.Widgets.vtkOrientationMarkerWidget.newInstance({\n                    actor: axes,\n                    interactor: renderWindow.getInteractor(),\n                });\n                widget.setEnabled(true);\n                widget.setViewportCorner(\n                    vtk.Interaction.Widgets.vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT\n                );\n                widget.setViewportSize(0.15);\n\n                renderer.resetCamera();\n                renderer.resetCameraClippingRange();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n\n</html>",
  "generated_code": "```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>VTK.js - Sliced Rotor Visualization</title>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <style>\n        body, html {\n            margin: 0;\n            padding: 0;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n        #container {\n            width: 100%;\n            height: 100%;\n        }\n    </style>\n</head>\n<body>\n    <div id=\"container\"></div>\n    <script>\n        // Load the VTK.js library and set up the visualization\n        const { vtkFullScreenRenderWindow, vtkHttpDataSetReader, vtkSliceRepresentation, vtkOrientationMarkerWidget, vtkColorTransferFunction, vtkPiecewiseFunction } = vtk;\n\n        // Create a full-screen render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({\n            rootContainer: document.getElementById('container'),\n            background: [0, 0, 0],\n        });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // Create a VTK HTTP dataset reader to load the rotor.vti file\n        const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n        reader.setUrl('http://127.0.0.1:5000/dataset/rotor.vti').then(() => {\n            reader.loadData().then(() => {\n                // Create a slice representation\n                const sliceRep = vtkSliceRepresentation.newInstance();\n                sliceRep.setInputData(reader.getOutputData());\n                sliceRep.setActiveScalar('Pressure');\n\n                // Set the slice at 80% depth along the Y-axis\n                sliceRep.setSlice(0.8);\n                sliceRep.setSlicingMode(vtkSliceRepresentation.SlicingMode.Y_AXIS);\n\n                // Create a color transfer function for pressure mapping (blue→white→red gradient)\n                const colorTransferFunction = vtkColorTransferFunction.newInstance();\n                colorTransferFunction.addRGBPoint(-100, 0, 0, 1); // Blue\n                colorTransferFunction.addRGBPoint(0, 1, 1, 1);   // White\n                colorTransferFunction.addRGBPoint(100, 1, 0, 0);  // Red\n\n                // Create a piecewise function for full opacity\n                const opacityTransferFunction = vtkPiecewiseFunction.newInstance();\n                opacityTransferFunction.addPoint(-100, 1);\n                opacityTransferFunction.addPoint(100, 1);\n\n                // Apply the color and opacity transfer functions to the slice representation\n                sliceRep.setColorTransferFunction(colorTransferFunction);\n                sliceRep.setOpacityTransferFunction(opacityTransferFunction);\n\n                // Add the slice representation to the renderer\n                renderer.addViewProp(sliceRep.getActor());\n\n                // Add an orientation marker (XYZ axes) for spatial reference\n                const axes = vtkOrientationMarkerWidget.newInstance({\n                    actor: vtkAxesActor.newInstance(),\n                    interactor: renderWindow.getInteractor(),\n                });\n                axes.setEnabled(true);\n                axes.setViewportCorner(vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT);\n                axes.setViewportSize(0.15);\n\n                // Render the scene\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n</html>\n```\n\n### Explanation:\n1. **VTK.js Library**: The script loads the VTK.js library from the provided CDN link.\n2. **Full-Screen Render Window**: A full-screen render window is created to display the visualization.\n3. **Dataset Loading**: The `vtkHttpDataSetReader` is used to load the `rotor.vti` dataset from the specified URL.\n4. **Slice Representation**: A `vtkSliceRepresentation` is created to handle the slicing of the dataset. The active scalar is set to \"Pressure\".\n5. **Slice Position**: The slice is positioned at 80% depth along the Y-axis using `setSlice` and `setSlicingMode`.\n6. **Color and Opacity Mapping**: A color transfer function is created to map pressure values to a gradient from blue to white to red. A piecewise function is used to ensure full opacity.\n7. **Orientation Marker**: An orientation marker (XYZ axes) is added to the scene for spatial reference.\n8. **Rendering**: The scene is rendered, and the camera is reset to ensure the entire slice is visible.\n\nThis code provides a clean and straightforward visualization of the sliced rotor data with the specified processing and visualization requirements.",
  "generator_prompt": "Please use vtkjs to generate visualization code. The code should be in the form of a complete code wrapped only in HTML tags. Please add your thinking process as comments in the code to make it easier to understand the code logic.\n\nIn the code, use `<script src=\"https://unpkg.com/vtk.js\"></script>` as the library for visualization to implement the visualization function.\nPlease follow the following rules:\n1. The content of the answer is HTML code with vtkjs script(start from <!DOCTYPE html>), and if there is any explanation, it should be given in the form of comments.\n2. If the sample code is relevant to the user's requirements, implement the user's requirements based on the sample code.\n3. The answer should be based on the provided sample information, and do not fabricate functions that do not exist. \nPlease implement the code strictly according to the specific requirements of the user in the `<QUESTION></QUESTION>` tag. Ensure that the code logic is clear and straightforward, and generate the visualization-related code completely in accordance with the syntax specifications of vtkjs. \n<QUESTION>__QUESTION__</QUESTION>\n\n",
  "final_prompt": "Generate HTML with vtk.js to visualize sliced rotor data\n\nLoad from http://127.0.0.1:5000/dataset/rotor.vti\n\nProcessing:\n- Slice ：Set as active scalar \"Pressure\"\n- Applies a Y-axis slice at 80% depth (setSlice, setSlicingMode).\nVisualization:\n- Maps pressure values to colors (blue→white→red gradient) and opacity (full opacity).\n- UI: Adds an orientation marker (XYZ axes) for spatial reference.\n6. No GUI controls required",
  "evaluator_prompt": "# Role: An expert for vtk.js and web-based scientific visualization\n# Ground truth: [GROUND_TRUTH]\n# Generated code: [GENERATED_CODE]\nThe ground truth code is provided by [Ground truth], please give a score for [Generated code] according to its readability and correctness. The score is between 0 to 1, and explain reasons for giving this score.\n### Response Format\n```\n<Score>[SCORE]</Score>\n<Explanation>[EXPLANATION]</Explanation>\n### Response Example\n<Score>0.8</Score>\n<Explanation>The generated code is readable and correct.</Explanation> ",
  "generator": "deepseek-v3",
  "evaluator": "qwen3-turbo",
  "score": "0.7",
  "workflow": {
    "inquiryExpansion": false,
    "rag": false,
    "iterativeLoop": false
  },
  "eval_id": "1748506530",
  "eval_user": "test",
  "export_time": "2025-05-29T08:16:34.175Z",
  "console_output": [
    {
      "type": "error",
      "message": "Error: Uncaught TypeError: Cannot read properties of undefined (reading 'newInstance') (at http://localhost:5174/:6:62)",
      "timestamp": "2025-05-29T08:16:14.560Z"
    }
  ],
  "eval_time": "2025-05-29 16:15:30",
  "evaluator_evaluation": "<Score>0.7</Score>\n<Explanation>The generated code is mostly readable and follows a logical structure, but there are some issues. It uses different VTK.js components (e.g., vtkSliceRepresentation) that were not present in the ground truth, which may not be accurate. Additionally, it uses hardcoded values like -100 and 100 for pressure that don't match the dynamic range calculated in the ground truth. The code also lacks proper error handling and does not fully replicate the original functionality, such as setting up the image mapper and slice properties correctly.</Explanation>",
  "options": null
}