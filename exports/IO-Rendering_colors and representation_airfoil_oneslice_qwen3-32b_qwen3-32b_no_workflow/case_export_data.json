{
  "path": "IO-Rendering\\colors and representation\\airfoil_oneslice\\description.txt",
  "name": "description.txt",
  "prompt": "Generate HTML with vtk.js to visualize volume rendering\n\nLoad from http://127.0.0.1:5000/dataset/airfoil_oneslice.vtp\nScalar Mapping:\nActivates the p scalar array for color encoding\nVisualization:\nRenders the colors and representation\npositions the camera to focus on the dataset bounds",
  "ground_truth": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>VTK.js Airfoil Rendering with Surface LIC</title>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <style>\n        body,\n        html {\n            margin: 0;\n            padding: 0;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n\n        #renderer {\n            width: 100%;\n            height: 100%;\n        }\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script>\n        // 导入所需的VTK.js类\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n        const vtkXMLPolyDataReader = vtk.IO.XML.vtkXMLPolyDataReader;\n        const vtkColorTransferFunction = vtk.Rendering.Core.vtkColorTransferFunction;\n        const vtkLookupTable = vtk.Common.Core.vtkLookupTable;\n        // 移除不存在的SurfaceLICMapper引用\n        // const vtkSurfaceLICMapper = vtk.Rendering.Core.vtkSurfaceLICMapper;\n\n        // 初始化渲染窗口\n        const fullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow.newInstance({\n            background: [0.1, 0.1, 0.1],\n        });\n        const renderWindow = fullScreenRenderWindow.getRenderWindow();\n        const renderer = fullScreenRenderWindow.getRenderer();\n\n        // 创建PolyData读取器\n        const reader = vtkXMLPolyDataReader.newInstance();\n\n        // 设置URL并加载数据\n        reader.setUrl('http://127.0.0.1:5000/dataset/airfoil_oneslice.vtp').then(() => {\n            reader.loadData().then(() => {\n                // 获取加载的多边形数据\n                const polyData = reader.getOutputData(0);\n\n                // 获取数据中的标量数组\n                const pointData = polyData.getPointData();\n                const arrays = pointData.getArrays();\n                const scalarNames = [];\n                arrays.forEach((array, name) => {\n                    scalarNames.push(name);\n                });\n                console.log('可用标量:', scalarNames);\n\n                // 选择p作为颜色标量\n                polyData.getPointData().setActiveScalars('p');\n                // 获取标量范围\n                const dataRange = polyData.getPointData().getScalars().getRange();\n                console.log('数据范围:', dataRange);\n\n                const mapper = vtkMapper.newInstance();\n                mapper.setInputData(polyData);\n\n                // 创建演员\n                const actor = vtkActor.newInstance();\n                actor.setMapper(mapper);\n                // 将演员添加到渲染器\n                renderer.addActor(actor);\n\n                // 计算数据边界和中心点\n                const bounds = polyData.getBounds();\n                const center = [\n                    (bounds[0] + bounds[1]) / 2, // X中心\n                    (bounds[2] + bounds[3]) / 2, // Y中心\n                    (bounds[4] + bounds[5]) / 2, // Z中心\n                ];\n\n                // 配置相机视角 - 根据图片调整为合适的视角\n                const camera = renderer.getActiveCamera();\n                camera.setFocalPoint(...center);\n                camera.setPosition(center[0], center[1], center[2] + 5);\n                camera.setViewUp(0, 1, 0);\n\n                // 重置相机和裁剪范围\n                renderer.resetCamera();\n                renderer.resetCameraClippingRange();\n\n                // 渲染场景\n                renderWindow.render();\n\n                // 添加坐标轴指示器\n                const axes = vtk.Rendering.Core.vtkAxesActor.newInstance();\n                const widget = vtk.Interaction.Widgets.vtkOrientationMarkerWidget.newInstance({\n                    actor: axes,\n                    interactor: renderWindow.getInteractor(),\n                });\n                widget.setEnabled(true);\n                widget.setViewportCorner(\n                    vtk.Interaction.Widgets.vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT\n                );\n                widget.setViewportSize(0.15);\n                widget.setMinPixelSize(100);\n                widget.setMaxPixelSize(300);\n            });\n        }).catch(error => {\n            console.error('加载数据集时出错:', error);\n        });\n    </script>\n</body>\n\n</html>",
  "generated_code": "```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>Volume Rendering with vtk.js</title>\n  <!-- Load the vtk.js library from a CDN -->\n  <script src=\"https://unpkg.com/vtk.js\"></script>\n  <style>\n    body, html {\n      margin: 0;\n      padding: 0;\n      overflow: hidden;\n    }\n    #vtkContainer {\n      width: 100vw;\n      height: 100vh;\n    }\n  </style>\n</head>\n<body>\n  <!-- Div container for the vtk render window -->\n  <div id=\"vtkContainer\"></div>\n\n  <script>\n    // Entry point of the application\n    (async function () {\n      // Import required modules from vtk.js\n      const vtk = window.vtk;\n      const vtkActor = vtk.Rendering.Core.vtkActor;\n      const vtkMapper = vtk.Rendering.Core.vtkMapper;\n      const vtkRenderWindow = vtk.Rendering.Core.vtkRenderWindow;\n      const vtkRenderer = vtk.Rendering.Core.vtkRenderer;\n      const vtkRenderWindowInteractor = vtk.Rendering.Core.vtkRenderWindowInteractor;\n      const vtkHttpDataSetReader = vtk.IO.HTTP.vtkHttpDataSetReader;\n      const vtkColorTransferFunction = vtk.Common.DataModel.vtkColorTransferFunction;\n\n      // Create the render window and renderer\n      const renderWindow = vtkRenderWindow.newInstance();\n      const renderer = vtkRenderer.newInstance();\n      renderWindow.addRenderer(renderer);\n\n      // Create an interactor to handle user interaction\n      const interactor = vtkRenderWindowInteractor.newInstance();\n      interactor.setRenderWindow(renderWindow);\n\n      // Create a reader to load the VTP file from the local server\n      const reader = vtkHttpDataSetReader.newInstance({ url: 'http://127.0.0.1:5000/dataset/airfoil_oneslice.vtp' });\n\n      // Wait for the data to be read\n      await reader.loadData();\n\n      // Create a mapper and set the input connection from the reader\n      const mapper = vtkMapper.newInstance();\n      mapper.setInputConnection(reader.getOutputPort());\n\n      // Set scalar visibility to true to use scalar values for color mapping\n      mapper.setScalarVisibility(true);\n      // Specify the scalar array name \"p\" for color encoding\n      mapper.setColorArrayName('p');\n      // Use scalar mode to map by point data\n      mapper.setScalarModeToUsePointData();\n\n      // Create a color transfer function for scalar mapping\n      const colorTransferFunction = vtkColorTransferFunction.newInstance();\n      // Add color stops for the scalar range (you can customize these as needed)\n      colorTransferFunction.addRGBPoint(0.0, 0.0, 0.0, 1.0); // Black at low scalar value\n      colorTransferFunction.addRGBPoint(1.0, 1.0, 0.0, 0.0); // Red at high scalar value\n\n      // Assign the color transfer function to the mapper\n      mapper.setLookupTable(colorTransferFunction);\n\n      // Create an actor and set the mapper\n      const actor = vtkActor.newInstance();\n      actor.setMapper(mapper);\n\n      // Add the actor to the renderer\n      renderer.addActor(actor);\n\n      // Get the bounds of the dataset to position the camera correctly\n      const bounds = reader.getOutputData().getBounds();\n      console.log(\"Dataset Bounds:\", bounds);\n\n      // Position the camera to focus on the dataset\n      const center = [\n        (bounds[0] + bounds[1]) / 2,\n        (bounds[2] + bounds[3]) / 2,\n        (bounds[4] + bounds[5]) / 2\n      ];\n\n      // Set camera position to view the dataset from a default angle\n      const camera = renderer.getActiveCamera();\n      camera.setPosition(center[0], center[1], center[2] + 50); // Adjust z-position for better view\n      camera.setFocalPoint(center[0], center[1], center[2]);\n      camera.setClippingRange(0.1, 1000);\n\n      // Render the scene\n      renderWindow.render();\n\n      // Start the interactor to enable mouse and keyboard controls\n      interactor.initialize();\n      interactor.start();\n    })();\n  </script>\n</body>\n</html>\n```",
  "generator_prompt": "Please use vtkjs to generate visualization code. The code should be in the form of a complete code wrapped only in HTML tags. Please add your thinking process as comments in the code to make it easier to understand the code logic.\n\nIn the code, use `<script src=\"https://unpkg.com/vtk.js\"></script>` as the library for visualization to implement the visualization function.\nPlease follow the following rules:\n1. The content of the answer is HTML code with vtkjs script(start from <!DOCTYPE html>), and if there is any explanation, it should be given in the form of comments.\n2. If the sample code is relevant to the user's requirements, implement the user's requirements based on the sample code.\n3. The answer should be based on the provided sample information, and do not fabricate functions that do not exist. \nPlease implement the code strictly according to the specific requirements of the user in the `<QUESTION></QUESTION>` tag. Ensure that the code logic is clear and straightforward, and generate the visualization-related code completely in accordance with the syntax specifications of vtkjs. \n<QUESTION>__QUESTION__</QUESTION>\n\n",
  "final_prompt": "Generate HTML with vtk.js to visualize volume rendering\n\nLoad from http://127.0.0.1:5000/dataset/airfoil_oneslice.vtp\nScalar Mapping:\nActivates the p scalar array for color encoding\nVisualization:\nRenders the colors and representation\npositions the camera to focus on the dataset bounds",
  "evaluator_prompt": "# Role: An expert for vtk.js and web-based scientific visualization\n# Ground truth: [GROUND_TRUTH]\n# Generated code: [GENERATED_CODE]\nThe ground truth code is provided by [Ground truth], please give a score for [Generated code] according to its readability and correctness. The score is between 0 to 1, and explain reasons for giving this score.\n### Response Format\n```\n<Score>[SCORE]</Score>\n<Explanation>[EXPLANATION]</Explanation>\n### Response Example\n<Score>0.8</Score>\n<Explanation>The generated code is readable and correct.</Explanation> ",
  "generator": "qwen3-32b",
  "evaluator": "qwen3-32b",
  "score": "0.8",
  "workflow": {
    "inquiryExpansion": false,
    "rag": false,
    "iterativeLoop": false
  },
  "eval_id": "1748099876",
  "eval_user": "test",
  "eval_time": "2025-05-24 23:17:56",
  "evaluator_evaluation": null,
  "options": null,
  "evaluatorEvaluation": "<Score>0.8</Score>\n<Explanation>The generated code is mostly readable and correct, but there are a few issues compared to the ground truth:\n\n1. **Correctness**:\n   - The code successfully loads a VTP file from the local server and sets up rendering using `vtkHttpDataSetReader`, `vtkMapper`, and `vtkActor`.\n   - It uses scalar visibility and color mapping with a custom color transfer function, which matches the ground truth's intention of visualizing scalar data.\n   - Camera positioning and centering based on dataset bounds is also handled correctly.\n\n2. **Missing Elements**:\n   - The ground truth includes a full-screen render window using `vtkFullScreenRenderWindow`, while the generated code manually creates `vtkRenderWindow` and `vtkRenderer`. This is not incorrect but less convenient for full-screen use.\n   - The ground truth adds an orientation marker (axes widget), which is missing in the generated code.\n\n3. **Readability**:\n   - The code is well-structured, uses modern JavaScript syntax (e.g., async/await), and includes clear comments, making it highly readable.\n   - However, some modules like `vtkColorTransferFunction` are imported from `Common.DataModel`, whereas in the ground truth, they are typically from `Rendering.Core`.\n\n4. **Minor Inconsistencies**:\n   - The camera z-position offset (`+50`) in the generated code is significantly different from the ground truth (`+5`). While this doesn't make it incorrect, it changes the view angle.\n\nOverall, the generated code is 80% aligned with the ground truth in terms of functionality and structure but lacks a few features and has minor deviations in module usage and camera setup.</Explanation>"
}