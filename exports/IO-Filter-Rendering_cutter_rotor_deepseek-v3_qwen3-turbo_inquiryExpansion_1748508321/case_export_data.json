{
  "path": "IO-Filter-Rendering\\cutter\\rotor\\description.txt",
  "name": "description.txt",
  "prompt": "Generate HTML with vtk.js to visualize sliced rotor data\n\nLoad from http://127.0.0.1:5000/dataset/rotor.vti\n\nProcessing:\n- Slice ：Set as active scalar \"Pressure\"\n- Applies a Y-axis slice at 80% depth (setSlice, setSlicingMode).\nVisualization:\n- Maps pressure values to colors (blue→white→red gradient) and opacity (full opacity).\n- UI: Adds an orientation marker (XYZ axes) for spatial reference.\n6. No GUI controls required",
  "ground_truth": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Rotor Dataset Cutting Rendering</title>\n    <style>\n        body,\n        html {\n            margin: 0;\n            padding: 0;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n\n        #renderer {\n            width: 100%;\n            height: 100%;\n        }\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n        const vtkXMLImageDataReader = vtk.IO.XML.vtkXMLImageDataReader;\n        const vtkPlane = vtk.Common.DataModel.vtkPlane;\n        const vtkCutter = vtk.Filters.Core.vtkCutter;\n        const vtkColorTransferFunction = vtk.Rendering.Core.vtkColorTransferFunction;\n\n        const fullScreenRenderWindow = vtkFullScreenRenderWindow.newInstance({\n            background: [0.1, 0.1, 0.1],\n        });\n        const renderWindow = fullScreenRenderWindow.getRenderWindow();\n        const renderer = fullScreenRenderWindow.getRenderer();\n\n        const reader = vtkXMLImageDataReader.newInstance();\n        reader.setUrl('http://127.0.0.1:5000/dataset/rotor_simplified.vti').then(() => {\n            reader.loadData().then(() => {\n                const imageData = reader.getOutputData(0);\n                imageData.getPointData().setActiveScalars('Pressure');\n\n                const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;\n                const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n\n                const imageMapper = vtkImageMapper.newInstance();\n                imageMapper.setInputData(imageData);\n                const dims = imageData.getDimensions();\n                imageMapper.setSlice(dims[1] * 0.8);\n                imageMapper.setSlicingMode(1); //(0:X, 1:Y, 2:Z)\n\n                const pressureArray = imageData.getPointData().getArrayByName('Pressure');\n                const [pMin, pMax] = pressureArray.getRange();\n                const colorTransferFunction = vtkColorTransferFunction.newInstance();\n                colorTransferFunction.addRGBPoint(pMin, 0.0, 0.0, 0.8);\n                colorTransferFunction.addRGBPoint((pMin + pMax) / 2, 1.0, 1.0, 1.0);\n                colorTransferFunction.addRGBPoint(pMax, 0.8, 0.0, 0.0);\n\n                // Add opacity transfer function\n                const vtkPiecewiseFunction = vtk.Common.DataModel.vtkPiecewiseFunction;\n                const opacityFunction = vtkPiecewiseFunction.newInstance();\n                opacityFunction.addPoint(pMin, 1.0);\n                opacityFunction.addPoint(pMax, 1.0);\n\n                const imageSlice = vtkImageSlice.newInstance();\n                imageSlice.setMapper(imageMapper);\n                imageSlice.getProperty().setRGBTransferFunction(0, colorTransferFunction);\n                imageSlice.getProperty().setPiecewiseFunction(0, opacityFunction);  // Set opacity function\n                imageSlice.getProperty().setScalarOpacity(0, opacityFunction);      // Set scalar opacity\n                imageSlice.getProperty().setUseLookupTableScalarRange(true);\n\n                renderer.addActor(imageSlice);\n\n                const axes = vtk.Rendering.Core.vtkAxesActor.newInstance();\n                const widget = vtk.Interaction.Widgets.vtkOrientationMarkerWidget.newInstance({\n                    actor: axes,\n                    interactor: renderWindow.getInteractor(),\n                });\n                widget.setEnabled(true);\n                widget.setViewportCorner(\n                    vtk.Interaction.Widgets.vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT\n                );\n                widget.setViewportSize(0.15);\n\n                renderer.resetCamera();\n                renderer.resetCameraClippingRange();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n\n</html>",
  "generated_code": "```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>VTK.js Rotor Slice Visualization</title>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <style>\n        body, html {\n            margin: 0;\n            padding: 0;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n        #container {\n            width: 100%;\n            height: 100%;\n        }\n    </style>\n</head>\n<body>\n    <div id=\"container\"></div>\n    <script>\n        // Import necessary VTK.js modules\n        const { vtkFullScreenRenderWindow, vtkHttpDataSetReader, vtkSliceRepresentation, vtkOrientationMarkerWidget, vtkColorTransferFunction } = vtk;\n\n        // Create a full-screen render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // Create a reader to load the dataset from the specified URL\n        const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n        reader.setUrl('http://127.0.0.1:5000/dataset/rotor.vti').then(() => {\n            // Set the active scalar to \"Pressure\"\n            const dataset = reader.getOutputData();\n            dataset.getPointData().setActiveScalars('Pressure');\n\n            // Create a slice representation\n            const sliceRep = vtkSliceRepresentation.newInstance();\n            sliceRep.setInputData(dataset);\n\n            // Set the slicing mode to Y-axis and slice at 80% depth\n            sliceRep.setSlicingMode('Y');\n            sliceRep.setSlice(dataset.getBounds()[3] * 0.8);\n\n            // Create a color transfer function to map pressure values to colors (blue→white→red gradient)\n            const colorTransferFunction = vtkColorTransferFunction.newInstance();\n            colorTransferFunction.addRGBPoint(0.0, 0.0, 0.0, 1.0); // Blue\n            colorTransferFunction.addRGBPoint(0.5, 1.0, 1.0, 1.0); // White\n            colorTransferFunction.addRGBPoint(1.0, 1.0, 0.0, 0.0); // Red\n\n            // Apply the color transfer function to the slice representation\n            sliceRep.getProperty().setRGBTransferFunction(0, colorTransferFunction);\n            sliceRep.getProperty().setScalarOpacity(0, 1.0); // Full opacity\n\n            // Add the slice representation to the renderer\n            renderer.addActor(sliceRep.getActor());\n\n            // Add an orientation marker (XYZ axes) for spatial reference\n            const axes = vtkOrientationMarkerWidget.newInstance({\n                actor: vtkAxesActor.newInstance(),\n                interactor: renderWindow.getInteractor(),\n            });\n            axes.setEnabled(true);\n            axes.setViewportCorner(vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT);\n            axes.setViewportSize(0.15);\n\n            // Render the scene\n            renderer.resetCamera();\n            renderWindow.render();\n        });\n    </script>\n</body>\n</html>\n```\n\n### Explanation:\n1. **Full-Screen Render Window**: We create a full-screen render window to display the visualization.\n2. **Dataset Loading**: We use `vtkHttpDataSetReader` to load the dataset from the specified URL.\n3. **Active Scalar**: We set the active scalar to \"Pressure\" to visualize the pressure data.\n4. **Slice Representation**: We create a `vtkSliceRepresentation` to slice the dataset along the Y-axis at 80% depth.\n5. **Color Mapping**: We define a color transfer function to map pressure values to a gradient from blue to white to red.\n6. **Opacity**: We set the opacity to full (1.0) to ensure the slice is fully visible.\n7. **Orientation Marker**: We add an orientation marker (XYZ axes) to provide spatial reference.\n8. **Rendering**: Finally, we render the scene and reset the camera to ensure the entire slice is visible.",
  "generator_prompt": "Please use vtkjs to generate visualization code. The code should be in the form of a complete code wrapped only in HTML tags. Please add your thinking process as comments in the code to make it easier to understand the code logic.\n\nIn the code, use `<script src=\"https://unpkg.com/vtk.js\"></script>` as the library for visualization to implement the visualization function.\nPlease follow the following rules:\n1. The content of the answer is HTML code with vtkjs script(start from <!DOCTYPE html>), and if there is any explanation, it should be given in the form of comments.\n2. If the sample code is relevant to the user's requirements, implement the user's requirements based on the sample code.\n3. The answer should be based on the provided sample information, and do not fabricate functions that do not exist. \nPlease implement the code strictly according to the specific requirements of the user in the `<QUESTION></QUESTION>` tag. Ensure that the code logic is clear and straightforward, and generate the visualization-related code completely in accordance with the syntax specifications of vtkjs. \n<QUESTION>__QUESTION__</QUESTION>\n\n",
  "final_prompt": "\n    用户需求分析：\n    1. 主要目标：Generate HTML with vtk.js to visualize sliced rotor data\n\nLoad from http://127.0.0.1:5000/dataset/rotor.vti\n\nProcessing:\n- Slice ：Set as active scalar \"Pressure\"\n- Applies a Y-axis slice at 80% depth (setSlice, setSlicingMode).\nVisualization:\n- Maps pressure values to colors (blue→white→red gradient) and opacity (full opacity).\n- UI: Adds an orientation marker (XYZ axes) for spatial reference.\n6. No GUI controls required\n    2. 数据来源：\n    3. 关键API：待确定\n    \n    \n        The relevant VTK.js example information is as follows: 示例 'Filter-ImageStreamline' 的描述:\n使用vtk.js创建了一个图像流线可视化工具，允许用户通过控件调整平面源的分辨率。\ncreates an image streamline visualization tool using vtk.js, with controls for the user to adjust the resolution of the plane source.\n\n示例 'ImageStreamline' 的描述:\n使用vtk.js创建了一个图像流线可视化工具，允许用户通过控件调整平面源的分辨率。\ncreates an image streamline visualization tool using vtk.js, with controls for the user to adjust the resolution of the plane source.\n\n示例 'Rendering-GlyphMapper' (code):\n// Mark the output vtkDataArray as modified\n                arraysOut.forEach((x) => x.modified());\n            },\n        });\n\n\n        // console.log(\"planeSource\", planeSource.getOutputPort)\n        // The generated 'temperature' array will become the default scalars, so the plane mapper will color by 'temperature':\n        simpleFilter.setInputConnection(planeSource.getOutputPort());\n\n        mapper.setInputConnection(simpleFilter.getOutputPort(), 0);\n\n        const coneSource = vtkConeSource.newInstance();\n        coneSource.setResolution(12);\n        mapper.setInputConnection(coneSource.getOutputPort(), 1);\n        mapper.setOrientationArray('pressure');\n        mapper.setScalarRange(0.0, 0.1);\n\n        actor.setMapper(mapper);\n\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n\n示例 'IO-XMLImageDataWriter' (code):\nmapper.setInputConnection(writerReader.getOutputPort());\n\n        // create color and opacity transfer functions\n        const ctfun = vtk.Rendering.Core.vtkColorTransferFunction.newInstance();\n        ctfun.addRGBPoint(200.0, 1.0, 1.0, 1.0);\n        ctfun.addRGBPoint(2000.0, 0.0, 0.0, 0.0);\n        const ofun = vtk.Common.DataModel.vtkPiecewiseFunction.newInstance();\n        ofun.addPoint(200.0, 0.0);\n        ofun.addPoint(1200.0, 0.2);\n        ofun.addPoint(4000.0, 0.4);\n        actor.getProperty().setRGBTransferFunction(0, ctfun);\n        actor.getProperty().setScalarOpacity(0, ofun);\n        actor.getProperty().setScalarOpacityUnitDistance(0, 4.5);\n        // actor.getProperty().setInterpolationTypeToNearest();\n        // actor.getProperty().setInterpolationTypeToFastLinear();\n        actor.getProperty().setInterpolationTypeToLinear();\n\n        renderer.addActor(actor);\n\n示例 'XMLImageDataWriter' (code):\nmapper.setInputConnection(writerReader.getOutputPort());\n\n        // create color and opacity transfer functions\n        const ctfun = vtk.Rendering.Core.vtkColorTransferFunction.newInstance();\n        ctfun.addRGBPoint(200.0, 1.0, 1.0, 1.0);\n        ctfun.addRGBPoint(2000.0, 0.0, 0.0, 0.0);\n        const ofun = vtk.Common.DataModel.vtkPiecewiseFunction.newInstance();\n        ofun.addPoint(200.0, 0.0);\n        ofun.addPoint(1200.0, 0.2);\n        ofun.addPoint(4000.0, 0.4);\n        actor.getProperty().setRGBTransferFunction(0, ctfun);\n        actor.getProperty().setScalarOpacity(0, ofun);\n        actor.getProperty().setScalarOpacityUnitDistance(0, 4.5);\n        // actor.getProperty().setInterpolationTypeToNearest();\n        // actor.getProperty().setInterpolationTypeToFastLinear();\n        actor.getProperty().setInterpolationTypeToLinear();\n\n        renderer.addActor(actor);\n\n        User question: Generate HTML with vtk.js to visualize sliced rotor data\n\nLoad from http://127.0.0.1:5000/dataset/rotor.vti\n\nProcessing:\n- Slice ：Set as active scalar \"Pressure\"\n- Applies a Y-axis slice at 80% depth (setSlice, setSlicingMode).\nVisualization:\n- Maps pressure values to colors (blue→white→red gradient) and opacity (full opacity).\n- UI: Adds an orientation marker (XYZ axes) for spatial reference.\n6. No GUI controls required\n        Please provide a detailed answer based on the above analysis and example information. Highlight how to meet the user's specific needs in the comments.\n        ",
  "evaluator_prompt": "# Role: An expert for vtk.js and web-based scientific visualization\n# Ground truth: [GROUND_TRUTH]\n# Generated code: [GENERATED_CODE]\nThe ground truth code is provided by [Ground truth], please give a score for [Generated code] according to its readability and correctness. The score is between 0 to 1, and explain reasons for giving this score.\n### Response Format\n```\n<Score>[SCORE]</Score>\n<Explanation>[EXPLANATION]</Explanation>\n### Response Example\n<Score>0.8</Score>\n<Explanation>The generated code is readable and correct.</Explanation> ",
  "generator": "deepseek-v3",
  "evaluator": "qwen3-turbo",
  "score": "0.7",
  "workflow": {
    "inquiryExpansion": true,
    "rag": true,
    "iterativeLoop": false
  },
  "eval_id": "1748508321",
  "eval_user": "test",
  "export_time": "2025-05-29T08:50:21.039Z",
  "console_output": [
    {
      "type": "error",
      "message": "Error: Uncaught TypeError: Cannot read properties of undefined (reading 'newInstance') (at http://localhost:5174/:6:62)",
      "timestamp": "2025-05-29T08:49:48.675Z"
    }
  ],
  "eval_time": "2025-05-29 16:45:21",
  "evaluator_evaluation": "<Score>0.7</Score>\n<Explanation>The generated code is mostly readable and follows a logical structure, but it has some correctness issues. It uses different VTK.js classes (e.g., vtkHttpDataSetReader, vtkSliceRepresentation) that may not be equivalent to the original code's approach with vtkXMLImageDataReader and vtkImageSlice. The slicing logic and color transfer function implementation are simplified or altered, which could affect the visualization outcome. Additionally, the generated code lacks some details like opacity functions and specific scalar range handling present in the ground truth.</Explanation>",
  "options": null
}