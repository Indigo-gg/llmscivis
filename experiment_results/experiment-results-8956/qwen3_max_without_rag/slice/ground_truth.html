<!DOCTYPE html>_x000d__x000d_
<html lang="en">_x000d__x000d_
_x000d__x000d_
<head>_x000d__x000d_
<meta charset="UTF-8">_x000d__x000d_
<meta name="viewport" content="width=device-width, initial-scale=1.0">_x000d__x000d_
<title>Rotor Dataset Cutting Rendering</title>_x000d__x000d_
<style>_x000d__x000d_
body,_x000d__x000d_
html {_x000d__x000d_
margin: 0;_x000d__x000d_
padding: 0;_x000d__x000d_
width: 100%;_x000d__x000d_
height: 100%;_x000d__x000d_
overflow: hidden;_x000d__x000d_
}_x000d__x000d_
_x000d__x000d_
#renderer {_x000d__x000d_
width: 100%;_x000d__x000d_
height: 100%;_x000d__x000d_
}_x000d__x000d_
</style>_x000d__x000d_
</head>_x000d__x000d_
_x000d__x000d_
<body>_x000d__x000d_
<div id="renderer"></div>_x000d__x000d_
<script src="https://unpkg.com/vtk.js@34.10.0/vtk.js"></script>_x000d__x000d_
<script>_x000d__x000d_
const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;_x000d__x000d_
const vtkActor = vtk.Rendering.Core.vtkActor;_x000d__x000d_
const vtkMapper = vtk.Rendering.Core.vtkMapper;_x000d__x000d_
const vtkXMLImageDataReader = vtk.IO.XML.vtkXMLImageDataReader;_x000d__x000d_
const vtkPlane = vtk.Common.DataModel.vtkPlane;_x000d__x000d_
const vtkColorTransferFunction = vtk.Rendering.Core.vtkColorTransferFunction;_x000d__x000d_
_x000d__x000d_
const fullScreenRenderWindow = vtkFullScreenRenderWindow.newInstance({_x000d__x000d_
background: [1, 1, 1],_x000d__x000d_
});_x000d__x000d_
const renderWindow = fullScreenRenderWindow.getRenderWindow();_x000d__x000d_
const renderer = fullScreenRenderWindow.getRenderer();_x000d__x000d_
_x000d__x000d_
const reader = vtkXMLImageDataReader.newInstance();_x000d__x000d_
reader.setUrl('http://127.0.0.1:5000/dataset/rotor_simplified.vti').then(() => {_x000d__x000d_
reader.loadData().then(() => {_x000d__x000d_
const imageData = reader.getOutputData(0);_x000d__x000d_
imageData.getPointData().setActiveScalars('Pressure');_x000d__x000d_
_x000d__x000d_
const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;_x000d__x000d_
const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;_x000d__x000d_
_x000d__x000d_
const imageMapper = vtkImageMapper.newInstance();_x000d__x000d_
imageMapper.setInputData(imageData);_x000d__x000d_
const dims = imageData.getDimensions();_x000d__x000d_
imageMapper.setSlice(dims[1] * 0.95);_x000d__x000d_
imageMapper.setSlicingMode(1); //(0:X, 1:Y, 2:Z)_x000d__x000d_
_x000d__x000d_
const pressureArray = imageData.getPointData().getArrayByName('Pressure');_x000d__x000d_
const [pMin, pMax] = pressureArray.getRange();_x000d__x000d_
const colorTransferFunction = vtkColorTransferFunction.newInstance();_x000d__x000d_
colorTransferFunction.addRGBPoint(pMin, 0.0, 0.0, 0.8);_x000d__x000d_
colorTransferFunction.addRGBPoint((pMin + pMax) / 2, 1.0, 1.0, 1.0);_x000d__x000d_
colorTransferFunction.addRGBPoint(pMax, 0.8, 0.0, 0.0);_x000d__x000d_
_x000d__x000d_
// Add opacity transfer function_x000d__x000d_
const vtkPiecewiseFunction = vtk.Common.DataModel.vtkPiecewiseFunction;_x000d__x000d_
const opacityFunction = vtkPiecewiseFunction.newInstance();_x000d__x000d_
opacityFunction.addPoint(pMin, 1.0);_x000d__x000d_
opacityFunction.addPoint(pMax, 1.0);_x000d__x000d_
_x000d__x000d_
const imageSlice = vtkImageSlice.newInstance();_x000d__x000d_
imageSlice.setMapper(imageMapper);_x000d__x000d_
imageSlice.getProperty().setRGBTransferFunction(0, colorTransferFunction);_x000d__x000d_
imageSlice.getProperty().setPiecewiseFunction(0, opacityFunction); // Set opacity function_x000d__x000d_
imageSlice.getProperty().setScalarOpacity(0, opacityFunction); // Set scalar opacity_x000d__x000d_
imageSlice.getProperty().setUseLookupTableScalarRange(true);_x000d__x000d_
_x000d__x000d_
renderer.addActor(imageSlice);_x000d__x000d_
_x000d__x000d_
const axes = vtk.Rendering.Core.vtkAxesActor.newInstance();_x000d__x000d_
const widget = vtk.Interaction.Widgets.vtkOrientationMarkerWidget.newInstance({_x000d__x000d_
actor: axes,_x000d__x000d_
interactor: renderWindow.getInteractor(),_x000d__x000d_
});_x000d__x000d_
widget.setEnabled(true);_x000d__x000d_
widget.setViewportCorner(_x000d__x000d_
vtk.Interaction.Widgets.vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT_x000d__x000d_
);_x000d__x000d_
widget.setViewportSize(0.15);_x000d__x000d_
_x000d__x000d_
renderer.resetCamera();_x000d__x000d_
renderer.resetCameraClippingRange();_x000d__x000d_
renderWindow.render();_x000d__x000d_
});_x000d__x000d_
});_x000d__x000d_
</script>_x000d__x000d_
</body>_x000d__x000d_
_x000d__x000d_
</html>