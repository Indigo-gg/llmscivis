[
  {
    "index": 1,
    "original_query": "Generate an HTML page using vtk.js to visualize the rotor dataset.\n\n- Load the dataset from: http://127.0.0.1:5000/dataset/rotor.vti\n- Set the active scalar array to \"Pressure\".\n- Apply a slice along the Y axis at 80% depth of the dataset (convert percentage to slice index).\n- Use a blue → white → red color map for pressure values, spanning from the minimum to maximum scalar range.\n- Set opacity to fully opaque (no transparency variation).\n- Add an orientation marker with XYZ axes in the bottom-right corner.\n- No interactive GUI controls are required.\n",
    "splited_queries": [
      {
        "description": "Introduce necessary VTK.js modules via the CDN link: https://unpkg.com/vtk.js;"
      },
      {
        "description": "Data Loading — Load the VTK dataset from http://127.0.0.1:5000/dataset/rotor.vti using vtkXMLImageDataReader;"
      },
      {
        "description": "Data Processing — Set 'Pressure' as the active scalar and apply a slice at 80% depth along the Y-axis using vtkImageSlice;"
      },
      {
        "description": "Visualization Setup — Map pressure values to a blue→white→red color gradient using vtkColorTransferFunction and set full opacity using vtkPiecewiseFunction, then associate with vtkMapper;"
      },
      {
        "description": "Add UI Element — Integrate an XYZ axes orientation marker in the bottom-right corner using vtkOrientationMarkerWidget and vtkAxesActor;"
      },
      {
        "description": "Integrate all components and render the visualization without GUI controls using vtkRenderWindow, vtkRenderer, vtkActor, and vtkView;"
      }
    ],
    "final_prompt": "\n    Generate only the HTML code without any additional text or markdown formatting.\n    User Requirements:\n    Generate an HTML page using vtk.js to visualize the rotor dataset.\n\n- Load the dataset from: http://127.0.0.1:5000/dataset/rotor.vti\n- Set the active scalar array to \"Pressure\".\n- Apply a slice along the Y axis at 80% depth of the dataset (convert percentage to slice index).\n- Use a blue → white → red color map for pressure values, spanning from the minimum to maximum scalar range.\n- Set opacity to fully opaque (no transparency variation).\n- Add an orientation marker with XYZ axes in the bottom-right corner.\n- No interactive GUI controls are required.\n\n\n    Relevant VTK.js Examples:\n    示例 1:\n描述: Displays a synthetic 2D image generated by `vtkRTAnalyticSource` using `vtkImageMapper` and `vtkImageSlice`.\nVTK.js 模块: ['vtk.Common.DataModel.vtkImageData', 'vtk.Filters.Sources.vtkRTAnalyticSource', 'vtk.Rendering.Core.vtkImageMapper', 'vtk.Rendering.Core.vtkImageSlice', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n\n        // create render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        const vtkImgSource = vtk.Filters.Sources.vtkRTAnalyticSource;\n        const imgSource = vtkImgSource.newInstance();\n        imgSource.update();\n        const img = imgSource.getOutputData();\n\n        // set mapper and actor\n        const mapper = vtkImageMapper.newInstance();\n        mapper.setInputData(img);\n\n        const actor = vtkImageSlice.newInstance();\n        actor.setMapper(mapper);\n\n        // adding actor to render\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n    </script>\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 2:\n描述: Loads and visualizes a 3D model (VTP format) from a remote URL using `vtkHttpDataSetReader` with gzip support.\n\nVTK.js 模块: ['vtk.IO.Core.DataAccessHelper.HttpDataAccessHelper', 'vtk.IO.Core.vtkHttpDataSetReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow', 'vtk.Rendering.OpenGL.Profiles.Geometry']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js IO-HttpDataSetReader</title>\n</head>\n\n<body>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const data_path = 'http://kitware.github.io/vtk-js/data/cow.vtp'\n        const vtkHttpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n        // const vtkGeometry = vtk.Rendering.OpenGL.Profiles.Geometry\n\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkActor = vtk.Rendering.Core.vtkActor\n        const vtkMapper = vtk.Rendering.Core.vtkMapper\n\n        // Force the loading of HttpDataAccessHelper to support gzip decompression\n        const vtkHttpDataAccessHelper = vtk.IO.Core.DataAccessHelper.HttpDataAccessHelper\n\n        // ----------------------------------------------------------------------------\n        // Standard rendering code setup\n        // ----------------------------------------------------------------------------\n\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance();\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // ----------------------------------------------------------------------------\n        // Example code\n        // ----------------------------------------------------------------------------\n        // Server is not sending the .gz and with the compress header\n        // Need to fetch the true file name and uncompress it locally\n        // ----------------------------------------------------------------------------\n\n        const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n        reader.setUrl(data_path).then(() => {\n            reader.loadData().then(() => {\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputConnection(reader.getOutputPort());\n\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n\n        renderer.addActor(actor);\n\n        // -----------------------------------------------------------\n        // Make some variables global so that you can inspect and\n        // modify objects in your browser's developer console:\n        // -----------------------------------------------------------\n\n        // global.source = reader;\n        // global.mapper = mapper;\n        // global.actor = actor;\n        // global.renderer = renderer;\n        // global.renderWindow = renderWindow;\n\n    </script>\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 3:\n描述: Loads and visualizes a 3D polygonal data file (`test_cone.vtp`) using `vtkXMLPolyDataReader` and `vtkMapper`.\n\nVTK.js 模块: ['vtk.IO.XML.vtkXMLPolyDataReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js loading poly data, need to start by live server</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkXMLPolyDataReader = vtk.IO.XML.vtkXMLPolyDataReader;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n\n        // crete the render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // load the vtp data locally\n        const reader = vtkXMLPolyDataReader.newInstance();\n        // set url and load the data\n        reader.setUrl('../datasets/test_cone.vtp').then(() => {\n            reader.loadData().then(() => {\n                // assign data to actor\n                const mapper = vtkMapper.newInstance();\n                console.log(reader.getOutputData(0))\n                mapper.setInputData(reader.getOutputData(0));\n                const actor = vtkActor.newInstance();\n                actor.setMapper(mapper);\n\n                //  adding actor to render and render the data\n                renderer.addActor(actor);\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n\n</html>\n\n\n--------------------------------------------------------------------------------------------------------------\n示例 4:\n描述: Generates and displays a 2D random image (100x100) using `vtkImageSlice` and `vtkImageMapper`.\n\nVTK.js 模块: ['vtk.Common.Core.vtkDataArray.newInstance', 'vtk.Common.DataModel.vtkImageData', 'vtk.Rendering.Core.vtkImageMapper', 'vtk.Rendering.Core.vtkImageSlice', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;//用于渲染二维图片切片的actor\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n\n        // 创建渲染窗口\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // 创建图像数据\n        const imageData = vtkImageData.newInstance();\n        imageData.setDimensions(100, 100, 1);\n        imageData.setSpacing(1.0, 1.0, 1.0);\n        imageData.setOrigin(0.0, 0.0, 0.0);\n\n        // 设置图像数据的像素值\n        const scalars = new Uint8Array(100 * 100);\n        for (let i = 0; i < 100 * 100; i++) {\n            scalars[i] = Math.random() * 255;\n        }\n        imageData.getPointData().setScalars(vtk.Common.Core.vtkDataArray.newInstance({ values: scalars, numberOfComponents: 1 }));\n\n        // 创建映射器和 actor\n        const mapper = vtkImageMapper.newInstance();\n        mapper.setInputData(imageData);\n\n        const actor = vtkImageSlice.newInstance();\n        actor.setMapper(mapper);\n\n        // 将 actor 添加到渲染器\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n    </script>\n</body>\n\n</html>\n\n\n            ",
    "generated_code": "```html\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>VTK.js Rotor Dataset Visualization</title>\n    <style>\n        body {\n            margin: 0;\n            padding: 0;\n        }\n    </style>\n</head>\n\n<body>\n    <div id=\"container\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        // Import required modules from vtk.js\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkHttpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkColorTransferFunction = vtk.Rendering.Core.vtkColorTransferFunction;\n        const vtkPiecewiseFunction = vtk.Common.DataModel.vtkPiecewiseFunction;\n        const vtkOrientationMarkerWidget = vtk.Interaction.Widgets.vtkOrientationMarkerWidget;\n        const vtkAnnotatedCubeActor = vtk.Rendering.Core.vtkAnnotatedCubeActor;\n\n        // Create a full-screen render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0.1, 0.1, 0.1] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // Load the dataset from specified URL\n        const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: false });\n        reader.setUrl('http://127.0.0.1:5000/dataset/rotor.vti').then(() => {\n            reader.loadData().then(() => {\n                const dataset = reader.getOutputData();\n\n                // Set active scalar array to \"Pressure\"\n                dataset.setActiveScalars('Pressure');\n\n                // Calculate Y-axis slice index at 80% depth\n                const dims = dataset.getDimensions();\n                const ySliceIndex = Math.round(dims[1] * 0.8);\n\n                // Create mapper and set slice\n                const mapper = vtkImageMapper.newInstance();\n                mapper.setInputData(dataset);\n                mapper.setSlice(ySliceIndex);\n                mapper.setOrientation(1); // Y-axis slice\n\n                // Set up color map: blue → white → red\n                const ctf = vtkColorTransferFunction.newInstance();\n                const range = dataset.getPointData().getScalars().getRange();\n                ctf.addRGBPoint(range[0], 0, 0, 1); // blue\n                ctf.addRGBPoint((range[0] + range[1]) / 2, 1, 1, 1); // white\n                ctf.addRGBPoint(range[1], 1, 0, 0); // red\n                mapper.setLookupTable(ctf);\n\n                // Set opacity to fully opaque\n                const ofun = vtkPiecewiseFunction.newInstance();\n                ofun.addPoint(0, 1.0);\n                ofun.addPoint(1, 1.0);\n                mapper.setUseLookupTableScalarRange(true);\n                mapper.setUseOpacityMapping(true);\n                mapper.setOpacityFunction(ofun);\n\n                // Create actor and add to renderer\n                const actor = vtkImageSlice.newInstance();\n                actor.setMapper(mapper);\n                renderer.addActor(actor);\n\n                // Add orientation marker (XYZ axes in bottom-right corner)\n                const cubeActor = vtkAnnotatedCubeActor.newInstance();\n                const orientationWidget = vtkOrientationMarkerWidget.newInstance({\n                    actor: cubeActor,\n                    interactor: fullScreenRenderer.getInteractor()\n                });\n                orientationWidget.setViewportCorner(1, 0); // bottom-right\n                orientationWidget.setViewportSize(0.15);\n                orientationWidget.setMinSize(100);\n                orientationWidget.setEnabled(true);\n\n                // Finalize rendering\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n\n</html>\n```",
    "retrieval_time": 0.27,
    "llm_generation_time": 31.43,
    "total_time": 31.7,
    "status": "success"
  },
  {
    "index": 2,
    "original_query": "Generate an HTML page using vtk.js to visualize the Deepwater dataset with isosurface rendering.\n\nLoad the dataset from: http://127.0.0.1:5000/dataset/deepwater.vti\n\nCompute velocity magnitude from arrays v02 and v03; if not available, use prs as the scalar\n\nGenerate an isosurface at the mid-value of the scalar range\n\nUse a blue → white → red color map spanning the scalar range (min to max)\n\nSet the isosurface to fully opaque with smooth shading\n\nAdd an XYZ orientation marker in the bottom-right corner",
    "splited_queries": [
      {
        "description": "Introduce necessary VTK.js modules via the CDN link: https://unpkg.com/vtk.js;"
      },
      {
        "description": "Data Loading — Load the VTI dataset from http://127.0.0.1:5000/dataset/deepwater.vti using vtkXMLImageDataReader;"
      },
      {
        "description": "Data Processing — Use vtkCalculator to compute velocity magnitude from arrays v02 and v03; if these arrays are not available, use 'prs' as the scalar field;"
      },
      {
        "description": "Isosurface Generation — Generate an isosurface at the mid-value of the scalar range using vtkImageMarchingCubes;"
      },
      {
        "description": "Color Mapping — Apply a blue→white→red color map spanning the scalar range (min to max) using vtkColorTransferFunction;"
      },
      {
        "description": "Surface Rendering — Set the isosurface to fully opaque with smooth shading using vtkMapper and vtkProperty;"
      },
      {
        "description": "Add UI Element — Integrate an XYZ orientation marker in the bottom-right corner using vtkOrientationMarkerWidget and vtkAxesActor;"
      },
      {
        "description": "Integrate all components and render the visualization using vtkRenderWindow, vtkRenderer, vtkActor, and vtkInteractorStyleTrackballCamera;"
      }
    ],
    "final_prompt": "\n    Generate only the HTML code without any additional text or markdown formatting.\n    User Requirements:\n    Generate an HTML page using vtk.js to visualize the Deepwater dataset with isosurface rendering.\n\nLoad the dataset from: http://127.0.0.1:5000/dataset/deepwater.vti\n\nCompute velocity magnitude from arrays v02 and v03; if not available, use prs as the scalar\n\nGenerate an isosurface at the mid-value of the scalar range\n\nUse a blue → white → red color map spanning the scalar range (min to max)\n\nSet the isosurface to fully opaque with smooth shading\n\nAdd an XYZ orientation marker in the bottom-right corner\n\n    Relevant VTK.js Examples:\n    示例 1:\n描述: Displays a synthetic 2D image generated by `vtkRTAnalyticSource` using `vtkImageMapper` and `vtkImageSlice`.\nVTK.js 模块: ['vtk.Common.DataModel.vtkImageData', 'vtk.Filters.Sources.vtkRTAnalyticSource', 'vtk.Rendering.Core.vtkImageMapper', 'vtk.Rendering.Core.vtkImageSlice', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n\n        // create render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        const vtkImgSource = vtk.Filters.Sources.vtkRTAnalyticSource;\n        const imgSource = vtkImgSource.newInstance();\n        imgSource.update();\n        const img = imgSource.getOutputData();\n\n        // set mapper and actor\n        const mapper = vtkImageMapper.newInstance();\n        mapper.setInputData(img);\n\n        const actor = vtkImageSlice.newInstance();\n        actor.setMapper(mapper);\n\n        // adding actor to render\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n    </script>\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 2:\n描述: Loads and visualizes a 3D model (VTP format) from a remote URL using `vtkHttpDataSetReader` with gzip support.\n\nVTK.js 模块: ['vtk.IO.Core.DataAccessHelper.HttpDataAccessHelper', 'vtk.IO.Core.vtkHttpDataSetReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow', 'vtk.Rendering.OpenGL.Profiles.Geometry']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js IO-HttpDataSetReader</title>\n</head>\n\n<body>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const data_path = 'http://kitware.github.io/vtk-js/data/cow.vtp'\n        const vtkHttpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n        // const vtkGeometry = vtk.Rendering.OpenGL.Profiles.Geometry\n\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkActor = vtk.Rendering.Core.vtkActor\n        const vtkMapper = vtk.Rendering.Core.vtkMapper\n\n        // Force the loading of HttpDataAccessHelper to support gzip decompression\n        const vtkHttpDataAccessHelper = vtk.IO.Core.DataAccessHelper.HttpDataAccessHelper\n\n        // ----------------------------------------------------------------------------\n        // Standard rendering code setup\n        // ----------------------------------------------------------------------------\n\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance();\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // ----------------------------------------------------------------------------\n        // Example code\n        // ----------------------------------------------------------------------------\n        // Server is not sending the .gz and with the compress header\n        // Need to fetch the true file name and uncompress it locally\n        // ----------------------------------------------------------------------------\n\n        const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n        reader.setUrl(data_path).then(() => {\n            reader.loadData().then(() => {\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputConnection(reader.getOutputPort());\n\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n\n        renderer.addActor(actor);\n\n        // -----------------------------------------------------------\n        // Make some variables global so that you can inspect and\n        // modify objects in your browser's developer console:\n        // -----------------------------------------------------------\n\n        // global.source = reader;\n        // global.mapper = mapper;\n        // global.actor = actor;\n        // global.renderer = renderer;\n        // global.renderWindow = renderWindow;\n\n    </script>\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 3:\n描述: Loads and visualizes a 3D polygonal data file (`test_cone.vtp`) using `vtkXMLPolyDataReader` and `vtkMapper`.\n\nVTK.js 模块: ['vtk.IO.XML.vtkXMLPolyDataReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js loading poly data, need to start by live server</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkXMLPolyDataReader = vtk.IO.XML.vtkXMLPolyDataReader;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n\n        // crete the render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // load the vtp data locally\n        const reader = vtkXMLPolyDataReader.newInstance();\n        // set url and load the data\n        reader.setUrl('../datasets/test_cone.vtp').then(() => {\n            reader.loadData().then(() => {\n                // assign data to actor\n                const mapper = vtkMapper.newInstance();\n                console.log(reader.getOutputData(0))\n                mapper.setInputData(reader.getOutputData(0));\n                const actor = vtkActor.newInstance();\n                actor.setMapper(mapper);\n\n                //  adding actor to render and render the data\n                renderer.addActor(actor);\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n\n</html>\n\n\n--------------------------------------------------------------------------------------------------------------\n示例 4:\n描述: Generates and displays a 2D random image (100x100) using `vtkImageSlice` and `vtkImageMapper`.\n\nVTK.js 模块: ['vtk.Common.Core.vtkDataArray.newInstance', 'vtk.Common.DataModel.vtkImageData', 'vtk.Rendering.Core.vtkImageMapper', 'vtk.Rendering.Core.vtkImageSlice', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;//用于渲染二维图片切片的actor\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n\n        // 创建渲染窗口\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // 创建图像数据\n        const imageData = vtkImageData.newInstance();\n        imageData.setDimensions(100, 100, 1);\n        imageData.setSpacing(1.0, 1.0, 1.0);\n        imageData.setOrigin(0.0, 0.0, 0.0);\n\n        // 设置图像数据的像素值\n        const scalars = new Uint8Array(100 * 100);\n        for (let i = 0; i < 100 * 100; i++) {\n            scalars[i] = Math.random() * 255;\n        }\n        imageData.getPointData().setScalars(vtk.Common.Core.vtkDataArray.newInstance({ values: scalars, numberOfComponents: 1 }));\n\n        // 创建映射器和 actor\n        const mapper = vtkImageMapper.newInstance();\n        mapper.setInputData(imageData);\n\n        const actor = vtkImageSlice.newInstance();\n        actor.setMapper(mapper);\n\n        // 将 actor 添加到渲染器\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n    </script>\n</body>\n\n</html>\n\n\n            ",
    "generated_code": "```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Deepwater Isosurface Visualization</title>\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"container\"></div>\n  <script src=\"https://unpkg.com/vtk.js\"></script>\n  <script>\n    // Import required VTK.js modules\n    const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n    const vtkHttpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n    const vtkMapper = vtk.Rendering.Core.vtkMapper;\n    vtk.Rendering.OpenGL.PolyDataMapper; // Ensure this is loaded\n    const vtkActor = vtk.Rendering.Core.vtkActor;\n    const vtkColorTransferFunction = vtk.Rendering.Core.vtkColorTransferFunction;\n    const vtkPiecewiseFunction = vtk.Common.DataModel.vtkPiecewiseFunction;\n    const vtkOutlineFilter = vtk.Filters.General.vtkOutlineFilter;\n    const vtkOrientationMarkerWidget = vtk.Interaction.Widgets.vtkOrientationMarkerWidget;\n    const vtkAnnotatedCubeActor = vtk.Rendering.Core.vtkAnnotatedCubeActor;\n\n    // Create the full screen render window\n    const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0.1, 0.1, 0.2] });\n    const renderer = fullScreenRenderer.getRenderer();\n    const renderWindow = fullScreenRenderer.getRenderWindow();\n\n    // Load dataset from URL\n    const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n    reader.setUrl('http://127.0.0.1:5000/dataset/deepwater.vti').then(() => {\n      reader.loadData().then(() => {\n        const dataset = reader.getOutputData();\n\n        // Compute velocity magnitude if possible, fallback to prs\n        let scalarName = 'prs';\n        const v02 = dataset.getPointData().getArrayByName('v02');\n        const v03 = dataset.getPointData().getArrayByName('v03');\n        if (v02 && v03) {\n          const mag = new Float32Array(v02.getData().length);\n          for (let i = 0; i < mag.length; i++) {\n            mag[i] = Math.sqrt(v02.getValue(i) ** 2 + v03.getValue(i) ** 2);\n          }\n          const array = vtk.Common.Core.vtkDataArray.newInstance({\n            name: 'velocity_magnitude',\n            values: mag,\n            numberOfComponents: 1,\n          });\n          dataset.getPointData().addArray(array);\n          scalarName = 'velocity_magnitude';\n        }\n\n        // Get scalar range\n        const scalarRange = dataset.getPointData().getArrayByName(scalarName).getRange();\n        const isoValue = (scalarRange[0] + scalarRange[1]) / 2;\n\n        // Create contour filter to generate isosurface\n        const contour = vtk.Filters.General.vtkContourFilter.newInstance();\n        contour.setInputData(dataset);\n        contour.setNumberOfContours(1);\n        contour.setValue(0, isoValue);\n\n        // Create mapper\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputConnection(contour.getOutputPort());\n        mapper.setScalarModeToUsePointData();\n        mapper.selectColorArray(scalarName);\n        mapper.setScalarVisibility(true);\n        mapper.interpolateScalarsBeforeMappingOn();\n\n        // Setup color map: blue -> white -> red\n        const cfun = vtkColorTransferFunction.newInstance();\n        cfun.addRGBPoint(scalarRange[0], 0, 0, 1); // blue\n        cfun.addRGBPoint((scalarRange[0] + scalarRange[1]) / 2, 1, 1, 1); // white\n        cfun.addRGBPoint(scalarRange[1], 1, 0, 0); // red\n\n        // Apply color map to mapper\n        mapper.setLookupTable(cfun);\n\n        // Create actor and set properties\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n        actor.getProperty().setOpacity(1.0); // fully opaque\n        actor.getProperty().setInterpolationToPhong(); // smooth shading\n\n        // Add actor to scene\n        renderer.addActor(actor);\n\n        // Optional: Add outline for reference\n        const outlineFilter = vtkOutlineFilter.newInstance();\n        outlineFilter.setInputData(dataset);\n        const outlineMapper = vtkMapper.newInstance();\n        outlineMapper.setInputConnection(outlineFilter.getOutputPort());\n        const outlineActor = vtkActor.newInstance();\n        outlineActor.setMapper(outlineMapper);\n        outlineActor.getProperty().setColor(1, 1, 1);\n        renderer.addActor(outlineActor);\n\n        // Add XYZ orientation marker in bottom-right\n        const cubeActor = vtkAnnotatedCubeActor.newInstance();\n        cubeActor.setDefaultStyle({\n          faceRotation: 0,\n          text: { fontFamily: 'Arial', fontSize: 18, color: 'white' },\n          xFace: { label: 'X', color: [1, 0, 0] },\n          yFace: { label: 'Y', color: [0, 1, 0] },\n          zFace: { label: 'Z', color: [0, 0, 1] },\n        });\n\n        const orientationWidget = vtkOrientationMarkerWidget.newInstance({\n          actor: cubeActor,\n          interactor: fullScreenRenderer.getInteractor(),\n        });\n        orientationWidget.setViewportCorner(0.8, 0.0, 0.2, 0.2); // Bottom-right\n        orientationWidget.setMinSize(100);\n        orientationWidget.setSize(150);\n        orientationWidget.setEnabled(true);\n\n        // Final setup\n        renderer.resetCamera();\n        renderWindow.render();\n      });\n    });\n  </script>\n</body>\n</html>\n```",
    "retrieval_time": 0.09,
    "llm_generation_time": 57.66,
    "total_time": 57.75,
    "status": "success"
  },
  {
    "index": 3,
    "original_query": "Generate an HTML page using vtk.js to visualize the Isabel dataset with streamline rendering.\n\nLoad the dataset from: http://127.0.0.1:5000/dataset/isabel.vti\n\nUse the \"Velocity\" array as the vector field for streamlines\n\nGenerate seed points at the center of the dataset with sufficient density to cover the domain\n\nCompute streamlines following the velocity field\n\nRender streamlines in cyan ([0, 1, 1]) with a specified line width\n\nRender a dataset outline in red ([1, 0, 0]) with a specified line width",
    "splited_queries": [
      {
        "description": "Introduce necessary VTK.js modules via the CDN link: https://unpkg.com/vtk.js;"
      },
      {
        "description": "Data Loading — Load the Isabel dataset from http://127.0.0.1:5000/dataset/isabel.vti using vtkXMLImageDataReader;"
      },
      {
        "description": "Data Preparation — Extract the 'Velocity' array as the vector field for streamline computation;"
      },
      {
        "description": "Seed Point Generation — Create seed points at the center of the dataset with sufficient density to cover the domain using vtkPointSource or vtkProgrammableSource;"
      },
      {
        "description": "Streamline Computation — Compute streamlines following the velocity field using vtkStreamTracer;"
      },
      {
        "description": "Streamline Visualization — Render streamlines in cyan ([0, 1, 1]) with a specified line width using vtkPolyDataMapper and vtkActor;"
      },
      {
        "description": "Outline Generation — Extract the outline of the dataset using vtkOutlineFilter;"
      },
      {
        "description": "Outline Rendering — Render the dataset outline in red ([1, 0, 0]) with a specified line width using vtkPolyDataMapper and vtkActor;"
      },
      {
        "description": "Integrate all components and render the visualization using vtkRenderWindow, vtkRenderer, vtkActor, and vtkViewStream;"
      }
    ],
    "final_prompt": "\n    Generate only the HTML code without any additional text or markdown formatting.\n    User Requirements:\n    Generate an HTML page using vtk.js to visualize the Isabel dataset with streamline rendering.\n\nLoad the dataset from: http://127.0.0.1:5000/dataset/isabel.vti\n\nUse the \"Velocity\" array as the vector field for streamlines\n\nGenerate seed points at the center of the dataset with sufficient density to cover the domain\n\nCompute streamlines following the velocity field\n\nRender streamlines in cyan ([0, 1, 1]) with a specified line width\n\nRender a dataset outline in red ([1, 0, 0]) with a specified line width\n\n    Relevant VTK.js Examples:\n    示例 1:\n描述: Displays a synthetic 2D image generated by `vtkRTAnalyticSource` using `vtkImageMapper` and `vtkImageSlice`.\nVTK.js 模块: ['vtk.Common.DataModel.vtkImageData', 'vtk.Filters.Sources.vtkRTAnalyticSource', 'vtk.Rendering.Core.vtkImageMapper', 'vtk.Rendering.Core.vtkImageSlice', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n\n        // create render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        const vtkImgSource = vtk.Filters.Sources.vtkRTAnalyticSource;\n        const imgSource = vtkImgSource.newInstance();\n        imgSource.update();\n        const img = imgSource.getOutputData();\n\n        // set mapper and actor\n        const mapper = vtkImageMapper.newInstance();\n        mapper.setInputData(img);\n\n        const actor = vtkImageSlice.newInstance();\n        actor.setMapper(mapper);\n\n        // adding actor to render\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n    </script>\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 2:\n描述: Loads and visualizes a 3D model (VTP format) from a remote URL using `vtkHttpDataSetReader` with gzip support.\n\nVTK.js 模块: ['vtk.IO.Core.DataAccessHelper.HttpDataAccessHelper', 'vtk.IO.Core.vtkHttpDataSetReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow', 'vtk.Rendering.OpenGL.Profiles.Geometry']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js IO-HttpDataSetReader</title>\n</head>\n\n<body>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const data_path = 'http://kitware.github.io/vtk-js/data/cow.vtp'\n        const vtkHttpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n        // const vtkGeometry = vtk.Rendering.OpenGL.Profiles.Geometry\n\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkActor = vtk.Rendering.Core.vtkActor\n        const vtkMapper = vtk.Rendering.Core.vtkMapper\n\n        // Force the loading of HttpDataAccessHelper to support gzip decompression\n        const vtkHttpDataAccessHelper = vtk.IO.Core.DataAccessHelper.HttpDataAccessHelper\n\n        // ----------------------------------------------------------------------------\n        // Standard rendering code setup\n        // ----------------------------------------------------------------------------\n\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance();\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // ----------------------------------------------------------------------------\n        // Example code\n        // ----------------------------------------------------------------------------\n        // Server is not sending the .gz and with the compress header\n        // Need to fetch the true file name and uncompress it locally\n        // ----------------------------------------------------------------------------\n\n        const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n        reader.setUrl(data_path).then(() => {\n            reader.loadData().then(() => {\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputConnection(reader.getOutputPort());\n\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n\n        renderer.addActor(actor);\n\n        // -----------------------------------------------------------\n        // Make some variables global so that you can inspect and\n        // modify objects in your browser's developer console:\n        // -----------------------------------------------------------\n\n        // global.source = reader;\n        // global.mapper = mapper;\n        // global.actor = actor;\n        // global.renderer = renderer;\n        // global.renderWindow = renderWindow;\n\n    </script>\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 3:\n描述: Loads and visualizes a 3D polygonal data file (`test_cone.vtp`) using `vtkXMLPolyDataReader` and `vtkMapper`.\n\nVTK.js 模块: ['vtk.IO.XML.vtkXMLPolyDataReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js loading poly data, need to start by live server</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkXMLPolyDataReader = vtk.IO.XML.vtkXMLPolyDataReader;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n\n        // crete the render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // load the vtp data locally\n        const reader = vtkXMLPolyDataReader.newInstance();\n        // set url and load the data\n        reader.setUrl('../datasets/test_cone.vtp').then(() => {\n            reader.loadData().then(() => {\n                // assign data to actor\n                const mapper = vtkMapper.newInstance();\n                console.log(reader.getOutputData(0))\n                mapper.setInputData(reader.getOutputData(0));\n                const actor = vtkActor.newInstance();\n                actor.setMapper(mapper);\n\n                //  adding actor to render and render the data\n                renderer.addActor(actor);\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n\n</html>\n\n\n--------------------------------------------------------------------------------------------------------------\n示例 4:\n描述: Generates and displays a 2D random image (100x100) using `vtkImageSlice` and `vtkImageMapper`.\n\nVTK.js 模块: ['vtk.Common.Core.vtkDataArray.newInstance', 'vtk.Common.DataModel.vtkImageData', 'vtk.Rendering.Core.vtkImageMapper', 'vtk.Rendering.Core.vtkImageSlice', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;//用于渲染二维图片切片的actor\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n\n        // 创建渲染窗口\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // 创建图像数据\n        const imageData = vtkImageData.newInstance();\n        imageData.setDimensions(100, 100, 1);\n        imageData.setSpacing(1.0, 1.0, 1.0);\n        imageData.setOrigin(0.0, 0.0, 0.0);\n\n        // 设置图像数据的像素值\n        const scalars = new Uint8Array(100 * 100);\n        for (let i = 0; i < 100 * 100; i++) {\n            scalars[i] = Math.random() * 255;\n        }\n        imageData.getPointData().setScalars(vtk.Common.Core.vtkDataArray.newInstance({ values: scalars, numberOfComponents: 1 }));\n\n        // 创建映射器和 actor\n        const mapper = vtkImageMapper.newInstance();\n        mapper.setInputData(imageData);\n\n        const actor = vtkImageSlice.newInstance();\n        actor.setMapper(mapper);\n\n        // 将 actor 添加到渲染器\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n    </script>\n</body>\n\n</html>\n\n\n            ",
    "generated_code": "```html\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>VTK.js Streamline Visualization of Isabel Dataset</title>\n    <style>\n        body {\n            margin: 0;\n        }\n    </style>\n</head>\n\n<body>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        // Import required VTK.js modules\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkHttpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n        const vtkStreamTracer = vtk.Filters.Flow.vtkStreamTracer;\n        const vtkSphereSource = vtk.Filters.Sources.vtkSphereSource;\n        const vtkGlyph3DMapper = vtk.Rendering.Core.vtkGlyph3DMapper;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n        const vtkOutlineFilter = vtk.Filters.General.vtkOutlineFilter;\n        const vtkDataArray = vtk.Common.Core.vtkDataArray;\n\n        // ----------------------------------------------------------------------------\n        // Create the render window and renderer\n        // ----------------------------------------------------------------------------\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // ----------------------------------------------------------------------------\n        // Load the Isabel dataset (VTI format) from the given URL\n        // ----------------------------------------------------------------------------\n        const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n        reader.setUrl('http://127.0.0.1:5000/dataset/isabel.vti');\n        reader.loadData().then(() => {\n            const dataset = reader.getOutputData();\n\n            // ----------------------------------------------------------------------------\n            // Extract dataset bounds to define the center and domain size\n            // ----------------------------------------------------------------------------\n            const bounds = dataset.getBounds();\n            const center = [\n                (bounds[0] + bounds[1]) / 2,\n                (bounds[2] + bounds[3]) / 2,\n                (bounds[4] + bounds[5]) / 2\n            ];\n            const lengthX = bounds[1] - bounds[0];\n            const lengthY = bounds[3] - bounds[2];\n            const lengthZ = bounds[5] - bounds[4];\n\n            // ----------------------------------------------------------------------------\n            // Create a sphere source at the center as seed for streamlines\n            // ----------------------------------------------------------------------------\n            const sphere = vtkSphereSource.newInstance();\n            sphere.setRadius(Math.min(lengthX, lengthY, lengthZ) * 0.05); // 5% of smallest dimension\n            sphere.setThetaResolution(8);\n            sphere.setPhiResolution(8);\n            sphere.setCenter(center);\n\n            // ----------------------------------------------------------------------------\n            // Compute streamlines using the \"Velocity\" vector field\n            // ----------------------------------------------------------------------------\n            const streamer = vtkStreamTracer.newInstance();\n            streamer.setInputData(dataset);\n            streamer.setSourceConnection(sphere.getOutputPort());\n            streamer.setVectorModeToUseVector();\n            streamer.setIntegratorTypeToRungeKutta4();\n            streamer.setMaximumNumberOfSteps(1000);\n            streamer.setMaximumPropagation(100.0);\n            streamer.setInitialIntegrationStep(0.1);\n            streamer.setTerminalSpeed(0.000001);\n            streamer.update();\n\n            // ----------------------------------------------------------------------------\n            // Render streamlines in cyan with specified line width\n            // ----------------------------------------------------------------------------\n            const streamlineMapper = vtkMapper.newInstance();\n            streamlineMapper.setInputData(streamer.getOutputData());\n\n            const streamlineActor = vtkActor.newInstance();\n            streamlineActor.setMapper(streamlineMapper);\n            streamlineActor.getProperty().setColor(0, 1, 1); // Cyan color\n            streamlineActor.getProperty().setLineWidth(2);   // Line width\n\n            // ----------------------------------------------------------------------------\n            // Create and render the outline of the dataset in red\n            // ----------------------------------------------------------------------------\n            const outlineFilter = vtkOutlineFilter.newInstance();\n            outlineFilter.setInputData(dataset);\n\n            const outlineMapper = vtkMapper.newInstance();\n            outlineMapper.setInputConnection(outlineFilter.getOutputPort());\n\n            const outlineActor = vtkActor.newInstance();\n            outlineActor.setMapper(outlineMapper);\n            outlineActor.getProperty().setColor(1, 0, 0); // Red color\n            outlineActor.getProperty().setLineWidth(2);   // Line width\n\n            // ----------------------------------------------------------------------------\n            // Add actors to the scene and render\n            // ----------------------------------------------------------------------------\n            renderer.addActor(streamlineActor);\n            renderer.addActor(outlineActor);\n            renderer.resetCamera();\n            renderWindow.render();\n        });\n    </script>\n</body>\n\n</html>\n```",
    "retrieval_time": 0.08,
    "llm_generation_time": 40.15,
    "total_time": 40.23,
    "status": "success"
  },
  {
    "index": 4,
    "original_query": "Generate an HTML page using vtk.js to visualize the Redsea dataset with volume rendering.\n\nLoad the dataset from: http://127.0.0.1:5000/dataset/redsea.vti\n\nCompute velocity magnitude from the \"velocity\" array and set it as the active scalar\n\nApply volume rendering using a blue → white → red color map spanning the scalar range (min to max)\n\nApply a piecewise opacity function to control transparency across scalar values\n\nSet shading, ambient, diffuse, and specular properties for realistic volume appearance\n\nAdjust the camera to look along +Z and center on the dataset",
    "splited_queries": [
      {
        "description": "Introduce necessary VTK.js modules via the CDN link: https://unpkg.com/vtk.js;"
      },
      {
        "description": "Data Loading — Load the Redsea dataset from http://127.0.0.1:5000/dataset/redsea.vti using vtkXMLImageDataReader;"
      },
      {
        "description": "Data Processing — Compute the velocity magnitude from the 'velocity' array and set it as the active scalar using vtkCalculator;"
      },
      {
        "description": "Visualization Setup — Apply a blue → white → red color map spanning the scalar range (min to max) using vtkColorTransferFunction;"
      },
      {
        "description": "Visualization Setup — Define a piecewise opacity function to control transparency across scalar values using vtkPiecewiseFunction;"
      },
      {
        "description": "Visualization Setup — Configure shading, ambient, diffuse, and specular properties for a realistic volume appearance using vtkVolumeProperty;"
      },
      {
        "description": "Volume Rendering — Render the dataset using vtkVolumeMapper and vtkVolumeActor;"
      },
      {
        "description": "Camera Setup — Adjust the camera to look along the +Z axis and center on the dataset using vtkCamera;"
      },
      {
        "description": "Integrate all components and render the visualization using vtkRenderWindow, vtkRenderer, vtkActor;"
      }
    ],
    "final_prompt": "\n    Generate only the HTML code without any additional text or markdown formatting.\n    User Requirements:\n    Generate an HTML page using vtk.js to visualize the Redsea dataset with volume rendering.\n\nLoad the dataset from: http://127.0.0.1:5000/dataset/redsea.vti\n\nCompute velocity magnitude from the \"velocity\" array and set it as the active scalar\n\nApply volume rendering using a blue → white → red color map spanning the scalar range (min to max)\n\nApply a piecewise opacity function to control transparency across scalar values\n\nSet shading, ambient, diffuse, and specular properties for realistic volume appearance\n\nAdjust the camera to look along +Z and center on the dataset\n\n    Relevant VTK.js Examples:\n    示例 1:\n描述: Displays a synthetic 2D image generated by `vtkRTAnalyticSource` using `vtkImageMapper` and `vtkImageSlice`.\nVTK.js 模块: ['vtk.Common.DataModel.vtkImageData', 'vtk.Filters.Sources.vtkRTAnalyticSource', 'vtk.Rendering.Core.vtkImageMapper', 'vtk.Rendering.Core.vtkImageSlice', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n\n        // create render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        const vtkImgSource = vtk.Filters.Sources.vtkRTAnalyticSource;\n        const imgSource = vtkImgSource.newInstance();\n        imgSource.update();\n        const img = imgSource.getOutputData();\n\n        // set mapper and actor\n        const mapper = vtkImageMapper.newInstance();\n        mapper.setInputData(img);\n\n        const actor = vtkImageSlice.newInstance();\n        actor.setMapper(mapper);\n\n        // adding actor to render\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n    </script>\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 2:\n描述: Loads and visualizes a 3D model (VTP format) from a remote URL using `vtkHttpDataSetReader` with gzip support.\n\nVTK.js 模块: ['vtk.IO.Core.DataAccessHelper.HttpDataAccessHelper', 'vtk.IO.Core.vtkHttpDataSetReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow', 'vtk.Rendering.OpenGL.Profiles.Geometry']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js IO-HttpDataSetReader</title>\n</head>\n\n<body>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const data_path = 'http://kitware.github.io/vtk-js/data/cow.vtp'\n        const vtkHttpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n        // const vtkGeometry = vtk.Rendering.OpenGL.Profiles.Geometry\n\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkActor = vtk.Rendering.Core.vtkActor\n        const vtkMapper = vtk.Rendering.Core.vtkMapper\n\n        // Force the loading of HttpDataAccessHelper to support gzip decompression\n        const vtkHttpDataAccessHelper = vtk.IO.Core.DataAccessHelper.HttpDataAccessHelper\n\n        // ----------------------------------------------------------------------------\n        // Standard rendering code setup\n        // ----------------------------------------------------------------------------\n\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance();\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // ----------------------------------------------------------------------------\n        // Example code\n        // ----------------------------------------------------------------------------\n        // Server is not sending the .gz and with the compress header\n        // Need to fetch the true file name and uncompress it locally\n        // ----------------------------------------------------------------------------\n\n        const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: true });\n        reader.setUrl(data_path).then(() => {\n            reader.loadData().then(() => {\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputConnection(reader.getOutputPort());\n\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n\n        renderer.addActor(actor);\n\n        // -----------------------------------------------------------\n        // Make some variables global so that you can inspect and\n        // modify objects in your browser's developer console:\n        // -----------------------------------------------------------\n\n        // global.source = reader;\n        // global.mapper = mapper;\n        // global.actor = actor;\n        // global.renderer = renderer;\n        // global.renderWindow = renderWindow;\n\n    </script>\n</body>\n\n</html>\n\n--------------------------------------------------------------------------------------------------------------\n示例 3:\n描述: Loads and visualizes a 3D polygonal data file (`test_cone.vtp`) using `vtkXMLPolyDataReader` and `vtkMapper`.\n\nVTK.js 模块: ['vtk.IO.XML.vtkXMLPolyDataReader', 'vtk.Rendering.Core.vtkActor', 'vtk.Rendering.Core.vtkMapper', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>vtk.js loading poly data, need to start by live server</title>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkXMLPolyDataReader = vtk.IO.XML.vtkXMLPolyDataReader;\n        const vtkActor = vtk.Rendering.Core.vtkActor;\n        const vtkMapper = vtk.Rendering.Core.vtkMapper;\n\n        // crete the render window\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // load the vtp data locally\n        const reader = vtkXMLPolyDataReader.newInstance();\n        // set url and load the data\n        reader.setUrl('../datasets/test_cone.vtp').then(() => {\n            reader.loadData().then(() => {\n                // assign data to actor\n                const mapper = vtkMapper.newInstance();\n                console.log(reader.getOutputData(0))\n                mapper.setInputData(reader.getOutputData(0));\n                const actor = vtkActor.newInstance();\n                actor.setMapper(mapper);\n\n                //  adding actor to render and render the data\n                renderer.addActor(actor);\n                renderer.resetCamera();\n                renderWindow.render();\n            });\n        });\n    </script>\n</body>\n\n</html>\n\n\n--------------------------------------------------------------------------------------------------------------\n示例 4:\n描述: Generates and displays a 2D random image (100x100) using `vtkImageSlice` and `vtkImageMapper`.\n\nVTK.js 模块: ['vtk.Common.Core.vtkDataArray.newInstance', 'vtk.Common.DataModel.vtkImageData', 'vtk.Rendering.Core.vtkImageMapper', 'vtk.Rendering.Core.vtkImageSlice', 'vtk.Rendering.Misc.vtkFullScreenRenderWindow']\n代码:\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    </style>\n</head>\n\n<body>\n    <div id=\"renderer\"></div>\n    <script src=\"https://unpkg.com/vtk.js\"></script>\n    <script>\n        const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n        const vtkImageSlice = vtk.Rendering.Core.vtkImageSlice;//用于渲染二维图片切片的actor\n        const vtkImageMapper = vtk.Rendering.Core.vtkImageMapper;\n        const vtkImageData = vtk.Common.DataModel.vtkImageData;\n\n        // 创建渲染窗口\n        const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance({ background: [0, 0, 0] });\n        const renderer = fullScreenRenderer.getRenderer();\n        const renderWindow = fullScreenRenderer.getRenderWindow();\n\n        // 创建图像数据\n        const imageData = vtkImageData.newInstance();\n        imageData.setDimensions(100, 100, 1);\n        imageData.setSpacing(1.0, 1.0, 1.0);\n        imageData.setOrigin(0.0, 0.0, 0.0);\n\n        // 设置图像数据的像素值\n        const scalars = new Uint8Array(100 * 100);\n        for (let i = 0; i < 100 * 100; i++) {\n            scalars[i] = Math.random() * 255;\n        }\n        imageData.getPointData().setScalars(vtk.Common.Core.vtkDataArray.newInstance({ values: scalars, numberOfComponents: 1 }));\n\n        // 创建映射器和 actor\n        const mapper = vtkImageMapper.newInstance();\n        mapper.setInputData(imageData);\n\n        const actor = vtkImageSlice.newInstance();\n        actor.setMapper(mapper);\n\n        // 将 actor 添加到渲染器\n        renderer.addActor(actor);\n        renderer.resetCamera();\n        renderWindow.render();\n    </script>\n</body>\n\n</html>\n\n\n            ",
    "generated_code": "```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Redsea Volume Rendering with VTK.js</title>\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n      overflow: hidden;\n    }\n  </style>\n</head>\n<body>\n<script src=\"https://unpkg.com/vtk.js\"></script>\n<script>\n  // Import required VTK.js modules\n  const vtkFullScreenRenderWindow = vtk.Rendering.Misc.vtkFullScreenRenderWindow;\n  const vtkHttpDataSetReader = vtk.IO.Core.vtkHttpDataSetReader;\n  const vtkDataArray = vtk.Common.Core.vtkDataArray;\n  const vtkColorTransferFunction = vtk.Rendering.Core.vtkColorTransferFunction;\n  const vtkPiecewiseFunction = vtk.Common.DataModel.vtkPiecewiseFunction;\n  const vtkVolume = vtk.Rendering.Core.vtkVolume;\n  const vtkVolumeMapper = vtk.Rendering.Core.vtkVolumeMapper;\n  const vtkVolumeProperty = vtk.Rendering.Core.vtkVolumeProperty;\n\n  // ----------------------------------------------------------------------------\n  // Initialize the render window and renderer\n  // ----------------------------------------------------------------------------\n  const fullScreenRenderer = vtkFullScreenRenderWindow.newInstance();\n  const renderer = fullScreenRenderer.getRenderer();\n  const renderWindow = fullScreenRenderer.getRenderWindow();\n\n  // ----------------------------------------------------------------------------\n  // Load the dataset from the specified URL\n  // ----------------------------------------------------------------------------\n  const reader = vtkHttpDataSetReader.newInstance({ fetchGzip: false });\n  reader.setUrl('http://127.0.0.1:5000/dataset/redsea.vti').then(() => {\n    reader.loadData().then(() => {\n      const dataset = reader.getOutputData();\n\n      // ----------------------------------------------------------------------------\n      // Compute velocity magnitude from the \"velocity\" array\n      // ----------------------------------------------------------------------------\n      const velocityArray = dataset.getPointData().getArrayByName('velocity');\n      if (!velocityArray) {\n        console.error(\"Velocity array not found in dataset.\");\n        return;\n      }\n\n      const numTuples = velocityArray.getNumberOfTuples();\n      const magnitudeData = new Float32Array(numTuples);\n\n      for (let i = 0; i < numTuples; i++) {\n        const [x, y, z] = velocityArray.getData(i);\n        magnitudeData[i] = Math.sqrt(x * x + y * y + z * z);\n      }\n\n      const magnitudeArray = vtkDataArray.newInstance({\n        name: 'velocity_magnitude',\n        values: magnitudeData,\n        numberOfComponents: 1,\n      });\n\n      dataset.getPointData().addArray(magnitudeArray);\n      dataset.getPointData().setScalars(magnitudeArray);\n\n      // ----------------------------------------------------------------------------\n      // Set up volume mapper\n      // ----------------------------------------------------------------------------\n      const mapper = vtkVolumeMapper.newInstance();\n      mapper.setInputData(dataset);\n\n      // ----------------------------------------------------------------------------\n      // Set up color transfer function (blue -> white -> red)\n      // ----------------------------------------------------------------------------\n      const colorTransferFunction = vtkColorTransferFunction.newInstance();\n      const range = magnitudeArray.getRange();\n      const [min, max] = range;\n      const mid = (min + max) / 2;\n\n      colorTransferFunction.addRGBPoint(min, 0.0, 0.0, 1.0); // blue\n      colorTransferFunction.addRGBPoint(mid, 1.0, 1.0, 1.0); // white\n      colorTransferFunction.addRGBPoint(max, 1.0, 0.0, 0.0); // red\n\n      // ----------------------------------------------------------------------------\n      // Set up piecewise opacity function\n      // ----------------------------------------------------------------------------\n      const opacityFunction = vtkPiecewiseFunction.newInstance();\n      opacityFunction.addPoint(min, 0.0);\n      opacityFunction.addPoint(min + 0.25 * (max - min), 0.2);\n      opacityFunction.addPoint(mid, 0.6);\n      opacityFunction.addPoint(max, 1.0);\n\n      // ----------------------------------------------------------------------------\n      // Configure volume property with shading and lighting parameters\n      // ----------------------------------------------------------------------------\n      const volumeProperty = vtkVolumeProperty.newInstance();\n      volumeProperty.setScalarOpacity(opacityFunction);\n      volumeProperty.setColor(colorTransferFunction);\n      volumeProperty.setInterpolationTypeToLinear();\n      volumeProperty.setAmbient(0.2);\n      volumeProperty.setDiffuse(0.7);\n      volumeProperty.setSpecular(0.6);\n      volumeProperty.setSpecularPower(10.0);\n      volumeProperty.setShade(true);\n\n      // ----------------------------------------------------------------------------\n      // Create and configure the volume actor\n      // ----------------------------------------------------------------------------\n      const volume = vtkVolume.newInstance();\n      volume.setMapper(mapper);\n      volume.setProperty(volumeProperty);\n\n      renderer.addVolume(volume);\n\n      // ----------------------------------------------------------------------------\n      // Adjust camera to look along +Z and center on dataset\n      // ----------------------------------------------------------------------------\n      renderer.resetCamera();\n      const camera = renderer.getActiveCamera();\n      camera.setFocalPoint(...dataset.getCenter());\n      camera.setPosition(dataset.getCenter()[0], dataset.getCenter()[1], dataset.getCenter()[2] - 100);\n      camera.setViewUp(0, 1, 0);\n\n      renderWindow.render();\n    });\n  });\n</script>\n</body>\n</html>\n```",
    "retrieval_time": 0.08,
    "llm_generation_time": 44.71,
    "total_time": 44.79,
    "status": "success"
  }
]